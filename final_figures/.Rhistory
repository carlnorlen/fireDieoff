#Add the Fire Severity Perimeters
fire.sev <- read_sf(file.path(sev_in, "VegBurnSeverity18.shp"))
fire.sev$intersects <- st_intersects(fire.sev, st_transform(usfs.sierra.union,c)) %>% lengths > 0
fire.sev.perimeter <- read_sf("D:\\Large_Files\\Fire_Severity\\veg_severity_perimeters\\veg_severity_perimeters.shp")
fire.sev.perimeter$intersects <- st_intersects(fire.sev.perimeter, st_transform(usfs.sierra.union,c)) %>% lengths > 0
fire.sev.perimeter$title <- 'Fire Severity Perimeters'
#Number of FRAP fires
frap %>% filter(intersects == TRUE & YEAR_ <= 2010 & YEAR_ >= 1987) %>% count()
#Number of rx fires
rxburn %>% filter(intersects == TRUE & YEAR_ <= 2010 & YEAR_ >= 1987) %>% count()
#Number of Fire severity fires
fire.sev.perimeter %>% filter(intersects == TRUE & FIRE_YEAR <= 2010 & FIRE_YEAR >= 1987) %>% count()
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_colour_manual(name="Fire Type",values=cols, aesthetics = 'color') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
#Add Fire colors
#Create the palette
cols <- c("Wild"=brewer_pal('div', "Set2")(2)[2], "Prescribed" = brewer_pal('div', "Set2")(2)[1])
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_colour_manual(name="Fire Type",values=cols, aesthetics = 'color') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_colour_manual(name="Fire Type",values=cols, aesthetics = 'color') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, fill = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, fill = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
#Create the fire severity palette
mypalette <- brewer_pal('seq', "YlOrRd")(5)[2:5]
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8, color = 'black') +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8, color = 'black') +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
p1a <- ggplot() +
geom_sf(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE), mapping = aes(fill = as.numeric(YEAR_))) +
geom_sf(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE), mapping = aes(fill = as.numeric(YEAR_))) +
geom_sf(data = usfs.sierra.union, color='black', size = 0.4,  fill = NA) +
coord_sf() + xlab('Longitude') + ylab('Latitude') +
scale_fill_viridis_c(name = 'Fire Year', option = 'inferno', na.value = NA) + theme_bw() + #facet_wrap(~title) +
theme(
legend.justification = c(1, 0),
legend.position = c(0.4, 0.1),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12), plot.margin = unit(c(0,0,0,0), "pt"),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
legend.direction = "vertical")
p1a
#Add Fire colors
#Create the palette
cols <- c("Wild"=brewer_pal('div', "Set2")(2)[2], "Prescribed" = brewer_pal('div', "Set2")(2)[1])
# lines <- c("Wild" = "dashed", "Prescribed" = "solid")
#Add the Burned Area Time Series
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, fill = "Wild"), linewidth = 1, color = 'black', alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, fill = "Prescribed"), linewidth = 1, color = 'black', alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p2 <- (p1a)
p3 <- (p1b / p1c)
(p2 | p3) + plot_layout(ncol = 2, widths = c(1.1, 0.9)) + plot_annotation(tag_levels = 'a')
#Save the plots
ggsave(filename = 'Fig1_fire_maps.png', height=18, width= 18, units = 'cm', dpi=900)
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, fill = "Wild"), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
#Create the fire severity palette
mypalette <- brewer_pal('seq', "YlOrRd")(5)[2:5]
#Create a time series of Fire Severity burned area
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
#Combining the panels into one plot with patchwork
p2 <- (p1a)
p3 <- (p1b / p1c)
(p2 | p3) + plot_layout(ncol = 2, widths = c(1.1, 0.9)) + plot_annotation(tag_levels = 'a')
#Save the plots
ggsave(filename = 'Fig1_fire_maps.png', height=18, width= 18, units = 'cm', dpi=900)
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & BURNSEV != 255) %>% #& intersects == TRUE
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, fill = "Wild"), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 ) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Wild"), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 ) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Wild"), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 ) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & BURNSEV != 255) %>% #& intersects == TRUE
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
#Combining the panels into one plot with patchwork
p2 <- (p1a)
p3 <- (p1b / p1c)
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Wild"), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
#Create the fire severity palette
mypalette <- brewer_pal('seq', "YlOrRd")(5)[2:5]
#Create a time series of Fire Severity burned area
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>% #
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
#Combining the panels into one plot with patchwork
p2 <- (p1a)
p3 <- (p1b / p1c)
(p2 | p3) + plot_layout(ncol = 2, widths = c(1.1, 0.9)) + plot_annotation(tag_levels = 'a')
#Save the plots
ggsave(filename = 'Fig1_fire_maps.png', height=18, width= 18, units = 'cm', dpi=900)
