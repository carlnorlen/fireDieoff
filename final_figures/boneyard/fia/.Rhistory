theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar"))
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5))
ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw()
summary(join.sp)
join.sp$tree_type.f <- factor(join.sp$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
join.sp$basal_area.dead.pct <-join.sp$basal_area.dead.pct * 100
summary(join.sp)
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire"))
#Die-off Mortality as a % of basal area
user_env()
#Die-off Mortality as a % of basal area
user_env
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
#ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9),
plot.tag = element_text(face = "bold"))
p4a
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = as.expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9),
plot.tag = element_text(face = "bold"))
is.expression('Mortality (m'^2*' ha'^-1*')')
as.expression('Mortality (m'^2*' ha'^-1*')')
expression('Mortality (m'^2*' ha'^-1*')')
p4b <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 8, color = 'black'), axis.title.x = element_text(size = 10, color = 'black'),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p4b
q1 <- dbSendQuery(db, "SELECT
t.tree, -- tree identified code
(t.carbon_ag * 2)*(t.tpa_unadj) live_biomass, -- biomass (lbs) of tree
t.tpa_unadj count, --trees/acre
t.dia, -- DBH in inches
t.ht, --Total live tree height in feet
t.actualht, --The measure height in feet
t.agentcd, --tree damage
t.mortyr, --mortality year
t.plot, t.statuscd, t.invyr, r.common_name, t.spcd, c.fortypcd,
c.fldtypcd, rft.meaning, c.stdage, c.fldage, t.totage, t.bhage,
c.dstrbcd1, c.dstrbyr1, c.owngrpcd
FROM
cond c,
plot p,
tree t, -- tree table must be included for tree-level estimates
ref_species r,
ref_forest_type rft
WHERE p.cn = c.plt_cn
AND t.plt_cn = c.plt_cn
AND t.condid = c.condid
AND c.cond_status_cd = 1 --2 means non-forest
--AND t.statuscd = 1 --1 means live trees, 2 means dead trees
AND t.spcd = r.spcd
AND t.dia >= 1.0 -- additional where_clause from ref_pop_attribute table
AND rft.value = c.fldtypcd
--South Sierra Nevada EcoRegions
AND (P.ECOSUBCD = 'M261Ep' OR P.ECOSUBCD = 'M261Eq' OR P.ECOSUBCD = 'M261Eu' OR P.ECOSUBCD = 'M261Eo' OR P.ECOSUBCD = 'M261Er' OR P.ECOSUBCD = 'M261Es') --South Sierra Nevada
--SoCal Mountains Ecoregions
--AND(P.ECOSUBCD = 'M262Bd' OR P.ECOSUBCD = 'M262Be' OR P.ECOSUBCD = 'M262Bg' OR P.ECOSUBCD = 'M262Bh' OR P.ECOSUBCD = 'M262Bf' OR P.ECOSUBCD = 'M262Bo' OR P.ECOSUBCD = 'M262Bi' OR P.ECOSUBCD = 'M262Bm' OR P.ECOSUBCD = 'M262Bl' OR P.ECOSUBCD = 'M262Bc' OR P.ECOSUBCD = 'M262Bp' OR P.ECOSUBCD = 'M262Bb' OR P.ECOSUBCD = 'M262Ba')
--Combined South Sierra and SoCal Mountains
--AND (P.ECOSUBCD = 'M261Ep' OR P.ECOSUBCD = 'M261Eq' OR P.ECOSUBCD = 'M261Eu' OR P.ECOSUBCD = 'M261Er' OR P.ECOSUBCD = 'M261Eo' OR P.ECOSUBCD = 'M261Es' OR P.ECOSUBCD = 'M262Bd' OR P.ECOSUBCD = 'M262Be' OR P.ECOSUBCD = 'M262Bg' OR P.ECOSUBCD = 'M262Bh' OR P.ECOSUBCD = 'M262Bf' OR P.ECOSUBCD = 'M262Bo' OR P.ECOSUBCD = 'M262Bi' OR P.ECOSUBCD = 'M262Bm' OR P.ECOSUBCD = 'M262Bl' OR P.ECOSUBCD = 'M262Bc' OR P.ECOSUBCD = 'M262Bp' OR P.ECOSUBCD = 'M262Bb' OR P.ECOSUBCD = 'M262Ba')
AND (c.dstrbcd1 = 0 OR c.dstrbcd1 = 30 OR c.dstrbcd1 = 31 OR c.dstrbcd1 = 32 OR c.dstrbcd1 = 10 OR c.dstrbcd1 = 11 OR c.dstrbcd1 = 12 OR c.dstrbcd1 = 54 OR c.dstrbcd1 = 70)
")
#DSTRBCD1 == 30, 31, 32 reference fires
all <- dbFetch(q1, n = -1)
# dbDisconnect(db)
summary(all)
#Convert per acre to per hectare
all$count <- all$count * 2.47105 # Convert to per hectare
all$DIA <- all$DIA * (2.54) #Convert to centimeters
all$basal_area <- (((all$DIA / 2)^2) * pi)*(1/10000) * all$count
#combined the data together
live <- all %>% filter(STATUSCD == 1) %>% group_by(INVYR, PLOT) %>% summarize(count.live = n(), tpa.live = sum(count), basal_area.live = sum(basal_area), STDAGE = first(STDAGE),
FORTYPCD = first(FORTYPCD), MEANING = first(MEANING), DSTRBCD1 = first(DSTRBCD1),
DSTRBYR1 = first(DSTRBYR1), OWNGRPCD = first(OWNGRPCD))
# all %>% filter(STATUSCD == 1)
# live
#There is a slightly different result when using INVYR instead of MORTYR to calculate annual mortality
dead.fire <- all %>% filter(STATUSCD == 2 & AGENTCD %in% c(30, 31, 32)) %>% group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
# dead <- dead %>% mutate(INVYR = MORTYR) & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019")
# dead
dead.drought <- all %>% filter(STATUSCD == 2 & AGENTCD %in% c(10, 20, 50, 70) &
MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019")) %>% group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
# dead <- dead %>% mutate(INVYR = MORTYR) & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019")
join.1 <- left_join(live, dead.fire, by = c('PLOT', 'INVYR'))
join <-  left_join(join.1, dead.drought, by = c('PLOT', 'INVYR'))
#Replace the NAs with 0s
join <- join %>% dplyr::mutate(basal_area.dead = replace(basal_area.dead, is.na(basal_area.dead), 0),
count.dead = replace(count.dead, is.na(count.dead), 0),
tpa.dead = replace(tpa.dead, is.na(tpa.dead), 0))
summary(join)
all <- dbFetch(q1, n = -1)
# dbDisconnect(db)
summary(all)
#Convert per acre to per hectare
all$count <- all$count * 2.47105 # Convert to per hectare
all$DIA <- all$DIA * (2.54) #Convert to centimeters
all$basal_area <- (((all$DIA / 2)^2) * pi)*(1/10000) * all$count
#combined the data together
live <- all %>% filter(STATUSCD == 1) %>% group_by(INVYR, PLOT) %>% summarize(count.live = n(), tpa.live = sum(count), basal_area.live = sum(basal_area), STDAGE = first(STDAGE),
FORTYPCD = first(FORTYPCD), MEANING = first(MEANING), DSTRBCD1 = first(DSTRBCD1),
DSTRBYR1 = first(DSTRBYR1), OWNGRPCD = first(OWNGRPCD))
# all %>% filter(STATUSCD == 1)
# live
#There is a slightly different result when using INVYR instead of MORTYR to calculate annual mortality
dead <- all %>% filter(STATUSCD == 2 & if(DSTRBCD1 %in% c(10, 11, 12, 54, 70)) {MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019")} ) %>%
group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
# all %>% filter(STATUSCD == 1)
all %>% summary()
q1 <- dbSendQuery(db, "SELECT
t.tree, -- tree identified code
(t.carbon_ag * 2)*(t.tpa_unadj) live_biomass, -- biomass (lbs) of tree
t.tpa_unadj count, --trees/acre
t.dia, -- DBH in inches
t.ht, --Total live tree height in feet
t.actualht, --The measure height in feet
t.agentcd, --tree damage
t.mortyr, --mortality year
t.plot, t.statuscd, t.invyr, r.common_name, t.spcd, c.fortypcd,
c.fldtypcd, rft.meaning, c.stdage, c.fldage, t.totage, t.bhage,
c.dstrbcd1, c.dstrbyr1, c.owngrpcd
FROM
cond c,
plot p,
tree t, -- tree table must be included for tree-level estimates
ref_species r,
ref_forest_type rft
WHERE p.cn = c.plt_cn
AND t.plt_cn = c.plt_cn
AND t.condid = c.condid
AND c.cond_status_cd = 1 --2 means non-forest
--AND t.statuscd = 1 --1 means live trees, 2 means dead trees
AND t.spcd = r.spcd
AND t.dia >= 1.0 -- additional where_clause from ref_pop_attribute table
AND rft.value = c.fldtypcd
--South Sierra Nevada EcoRegions
AND (P.ECOSUBCD = 'M261Ep' OR P.ECOSUBCD = 'M261Eq' OR P.ECOSUBCD = 'M261Eu' OR P.ECOSUBCD = 'M261Eo' OR P.ECOSUBCD = 'M261Er' OR P.ECOSUBCD = 'M261Es') --South Sierra Nevada
--SoCal Mountains Ecoregions
--AND(P.ECOSUBCD = 'M262Bd' OR P.ECOSUBCD = 'M262Be' OR P.ECOSUBCD = 'M262Bg' OR P.ECOSUBCD = 'M262Bh' OR P.ECOSUBCD = 'M262Bf' OR P.ECOSUBCD = 'M262Bo' OR P.ECOSUBCD = 'M262Bi' OR P.ECOSUBCD = 'M262Bm' OR P.ECOSUBCD = 'M262Bl' OR P.ECOSUBCD = 'M262Bc' OR P.ECOSUBCD = 'M262Bp' OR P.ECOSUBCD = 'M262Bb' OR P.ECOSUBCD = 'M262Ba')
--Combined South Sierra and SoCal Mountains
--AND (P.ECOSUBCD = 'M261Ep' OR P.ECOSUBCD = 'M261Eq' OR P.ECOSUBCD = 'M261Eu' OR P.ECOSUBCD = 'M261Er' OR P.ECOSUBCD = 'M261Eo' OR P.ECOSUBCD = 'M261Es' OR P.ECOSUBCD = 'M262Bd' OR P.ECOSUBCD = 'M262Be' OR P.ECOSUBCD = 'M262Bg' OR P.ECOSUBCD = 'M262Bh' OR P.ECOSUBCD = 'M262Bf' OR P.ECOSUBCD = 'M262Bo' OR P.ECOSUBCD = 'M262Bi' OR P.ECOSUBCD = 'M262Bm' OR P.ECOSUBCD = 'M262Bl' OR P.ECOSUBCD = 'M262Bc' OR P.ECOSUBCD = 'M262Bp' OR P.ECOSUBCD = 'M262Bb' OR P.ECOSUBCD = 'M262Ba')
AND (c.dstrbcd1 = 0 OR c.dstrbcd1 = 30 OR c.dstrbcd1 = 31 OR c.dstrbcd1 = 32 OR c.dstrbcd1 = 10 OR c.dstrbcd1 = 11 OR c.dstrbcd1 = 12 OR c.dstrbcd1 = 54 OR c.dstrbcd1 = 70)
")
#DSTRBCD1 == 30, 31, 32 reference fires
all <- dbFetch(q1, n = -1)
# dbDisconnect(db)
summary(all)
#Convert per acre to per hectare
all$count <- all$count * 2.47105 # Convert to per hectare
all$DIA <- all$DIA * (2.54) #Convert to centimeters
all$basal_area <- (((all$DIA / 2)^2) * pi)*(1/10000) * all$count
#combined the data together
live <- all %>% filter(STATUSCD == 1) %>% group_by(INVYR, PLOT) %>% summarize(count.live = n(), tpa.live = sum(count), basal_area.live = sum(basal_area), STDAGE = first(STDAGE),
FORTYPCD = first(FORTYPCD), MEANING = first(MEANING), DSTRBCD1 = first(DSTRBCD1),
DSTRBYR1 = first(DSTRBYR1), OWNGRPCD = first(OWNGRPCD))
# all %>% filter(STATUSCD == 1)
all %>% summary()
dead <- all %>% filter(STATUSCD == 2 & if(DSTRBCD1 %in% c(10, 11, 12, 54, 70)) {MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019")} ) %>%
group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
dead <- all %>% {if (DISTRCD1 %in% c(30,31,32)) filter(STATUSCD == 2) else filter(STATUSCD == 2 & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019"))} %>%
group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
dead <- all %>% {if (DSTRBCD1 %in% c(30,31,32)) filter(STATUSCD == 2) else filter(STATUSCD == 2 & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019"))} %>%
group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
dead <- all %>% {if (DSTRBCD1 %in% c('30','31','32')) filter(STATUSCD == 2) else filter(STATUSCD == 2 & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019"))} %>%
group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
# all %>% filter(STATUSCD == 1)
all %>% summary()
dead <- all %>% {if (DSTRBCD1 %in% c(30,31,32)) filter(., STATUSCD == 2) else filter(., STATUSCD == 2 & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019"))} %>%
group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
dead <- all %>% filter(case_when(DSTRBCD1 %in% c(30,31,32) ~ STATUSCD == 2, DSTRBCD1 %in% c(0,10,11,12,54,70) ~ STATUSCD == 2 & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019"))) %>%
group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
join <- left_join(live, dead, by = c('PLOT', 'INVYR'))
# join <-  left_join(join.1, dead, by = c('PLOT', 'INVYR'))
summary(join)
#Replace the NAs with 0s
join <- join %>% dplyr::mutate(basal_area.dead = replace(basal_area.dead, is.na(basal_area.dead), 0),
count.dead = replace(count.dead, is.na(count.dead), 0),
tpa.dead = replace(tpa.dead, is.na(tpa.dead), 0))
summary(join)
#Add the total basal area calculations
join$count.all <- join$count.live + join$count.dead
join$tpa.all <- join$tpa.live + join$tpa.dead
join$basal_area.all <- join$basal_area.live + join$basal_area.dead
join$basal_area.dead.pct <- join$basal_area.dead / join$basal_area.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join <- join %>% dplyr::mutate(basal_area.dead.pct = replace(basal_area.dead.pct, is.na(basal_area.dead.pct), 0))
join$tpa.dead.pct <- join$tpa.dead / join$tpa.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join <- join %>% dplyr::mutate(tpa.dead.pct = replace(tpa.dead.pct, is.na(tpa.dead.pct), 0))
# join %>% summary()
join$years.disturb <- join$INVYR - join$DSTRBYR1
# join %>% filter(DSTRBCD1 %in% c('31', '32') & INVYR %in% c('2001', '2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013')) %>% group_by(DSTRBCD1) %>% count()
join <- join %>% mutate(disturb.bin = case_when(
DSTRBCD1 %in% c(10, 11, 12, 54, 70) ~ 'Die-off',
DSTRBCD1 %in% c(31) ~ 'Ground Fire',
DSTRBCD1 %in% c(32) ~ 'Crown Fire',
DSTRBCD1 == 0 ~'No Disturbance'))
all$tree_type <- recode(.x=all$COMMON_NAME, 'California black oak' = 'oak', 'California juniper' = 'juniper', 'California live oak' = 'oak', 'California sycamore' = 'deciduous', 'Coulter pine' = 'pine', 'chinkapin oak' = 'oak', 'Jeffrey pine' = 'pine',
'bigcone Douglas-fir' = 'fir', 'bigleaf maple' = 'deciduous', 'canyon live oak' = 'oak', 'curlleaf mountain-mahogany' = 'deciduous', 'incense-cedar' = 'cedar', 'interior live oak' = 'oak', 'limber pine' = 'pine',
'lodgepole pine' = 'pine', 'ponderosa pine' = 'pine', 'singleleaf pinyon' = 'pine', 'sugar pine' = 'pine', 'Utah juniper' = 'juniper', 'western juniper' = 'juniper', 'white alder' = 'deciduous', 'white fir' = 'fir', 'California laurel' = 'deciduous',
'California-laurel' = 'deciduous', 'Oregon ash' = 'deciduous', 'Douglas-fir' = 'fir', 'honey mesquite' = 'deciduous', 'desert ironwood' = 'deciduous', 'California red fir' = 'fir', 'California buckeye' = 'deciduous', 'Engelmann oak' = 'oak', 'grand fir' = 'fir', 'western white pine' = 'pine',
"western white pine" = 'pine', "whitebark pine" = 'pine', "mountain hemlock" = "other conifer", "gray or California foothill pine" = "pine", "foxtail pine" = 'pine', "blue oak" = 'oak', "California white oak" = 'oak', "quaking aspen" = 'deciduous',
"giant sequoia" = 'other conifer', "Unknown dead conifer" = 'other conifer', "ash spp." = 'deciduous', "black cottonwood" = 'deciduous', "California torreya (nutmeg)" = 'deciduous', "Oregon white oak" = 'oak', "Port-Orford-cedar" = 'cedar', "Pacific dogwood" = 'deciduous',
"red alder" = 'deciduous', "bitter cherry" = 'deciduous', 'Rocky Mountain maple' = 'deciduous', 'unknown dead conifer' = 'other conifer')
all$tree_type <- as.factor(all$tree_type)
# test <- all %>% select(PLOT, INVYR) %>% group_by(PLOT, INVYR) %>% summarize(count = n())
#Create a tree type summary by plot
live.sp <- all %>% filter(STATUSCD == 1) %>%
group_by(INVYR, PLOT, tree_type, .drop = FALSE) %>%
summarize(count.live = n(), tpa.live = sum(count),
basal_area.live = sum(basal_area), STDAGE = median(STDAGE), FORTYPCD = median (FORTYPCD), MEANING = first(MEANING), DSTRBCD1 = first(DSTRBCD1),
DSTRBYR1 = first(DSTRBYR1), OWNGRPCD = first(OWNGRPCD))
live.sp
#There is a slightly different result when using INVYR instead of MORTYR to calculate annual mortality
dead.sp <- all %>% filter(case_when(DSTRBCD1 %in% c(30,31,32) ~ STATUSCD == 2, DSTRBCD1 %in% c(0,10,11,12,54,70) ~ STATUSCD == 2 & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019"))) %>%
group_by(PLOT, INVYR, tree_type, .drop = FALSE) %>%
summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
dead.sp
join.sp <- left_join(live.sp, dead.sp, by = c('PLOT', 'INVYR', 'tree_type'))
#Replace the NAs with 0s
join.sp <- join.sp %>% dplyr::mutate(basal_area.dead = replace(basal_area.dead, is.na(basal_area.dead), 0),
count.dead = replace(count.dead, is.na(count.dead), 0),
tpa.dead = replace(tpa.dead, is.na(tpa.dead), 0)
) %>% group_by(INVYR, PLOT, tree_type) %>%
fill(STDAGE, .direction = c("up"))
# join
# summary(join)
#Add the total basal area calculations
join.sp$count.all <- join.sp$count.live + join.sp$count.dead
join.sp$tpa.all <- join.sp$tpa.live + join.sp$tpa.dead
join.sp$basal_area.all <- join.sp$basal_area.live + join.sp$basal_area.dead
join.sp$basal_area.dead.pct <- join.sp$basal_area.dead / join.sp$basal_area.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join.sp <- join.sp %>% dplyr::mutate(basal_area.dead.pct = replace(basal_area.dead.pct, is.na(basal_area.dead.pct), 0))
join.sp$tpa.dead.pct <- join.sp$tpa.dead / join.sp$tpa.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join.sp <- join.sp %>% dplyr::mutate(tpa.dead.pct = replace(tpa.dead.pct, is.na(tpa.dead.pct), 0))
join.sp %>% summary()
join.sp <- join.sp %>% mutate(disturb.bin = case_when(
DSTRBCD1 %in% c(10, 11, 12, 54, 70) ~ 'Die-off',
DSTRBCD1 %in% c(31) ~ 'Ground Fire',
DSTRBCD1 %in% c(32) ~ 'Crown Fire',
DSTRBCD1 == 0 ~'No Disturbance'))
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9),
plot.tag = element_text(face = "bold"))
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
#ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9),
plot.tag = element_text(face = "bold"))
p4a
join.sp$tree_type.f <- join.sp$tree_type
join.sp$tree_type.f <- factor(join.sp$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
join.sp$basal_area.dead.pct <-join.sp$basal_area.dead.pct * 100
summary(join.sp)
#Die-off Mortality as a % of basal area
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
#ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9),
plot.tag = element_text(face = "bold"))
p4a
expression('Mortality (m'^2*' ha'^-1*')')
p4b <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 8, color = 'black'), axis.title.x = element_text(size = 10, color = 'black'),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p4b
#Combine the two figure panels into one
f4 <- ggarrange(p4a, p4b, ncol = 1, align = "v", labels = c("a", "b"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f4
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Die-off', 'Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
#ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c('Die-off', "Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9),
plot.tag = element_text(face = "bold"))
p4a
expression('Mortality (m'^2*' ha'^-1*')')
p4b <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Die-off', 'Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c('Die-off', "Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 8, color = 'black'), axis.title.x = element_text(size = 10, color = 'black'),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p4b
#Combine the two figure panels into one
f4 <- ggarrange(p4a, p4b, ncol = 1, align = "v", labels = c("a", "b"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f4
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Die-off', 'Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m^2/ha)'),
xlab = 'Disturbance', order = c('Die-off', "Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9),
plot.tag = element_text(face = "bold"))
p4a <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Die-off', 'Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
xlab = 'Disturbance', order = c('Die-off', "Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9),
plot.tag = element_text(face = "bold")) + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p4a
p4b <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Die-off', 'Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir',)),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c('Die-off', "Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 8, color = 'black'), axis.title.x = element_text(size = 10, color = 'black'),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
p4b <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Die-off', 'Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c('Die-off', "Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 8, color = 'black'), axis.title.x = element_text(size = 10, color = 'black'),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p4b
#Combine the two figure panels into one
f4 <- ggarrange(p4a, p4b, ncol = 1, align = "v", labels = c("a", "b"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f4
ggsave(filename = 'Fig8_fire_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
