q()
p <- c('ggpubr', 'viridis', 'tidyr', 'dplyr', 'ggplot2', 'stats', 'patchwork', 'data.table')
# install.packages(p,repo='https://cran.r-project.org/')
# install.packages(c('ggmap'),repo='https://cran.r-project.org/')
lapply(p,require,character.only=TRUE)
#Set the working directory
setwd('C:/Users/can02/mystuff/fireDieoff')
#Data directory
dir_in <- "D:\\Large_Files\\Fire_Dieoff"
#Add the data
data <- read.csv(file.path(dir_in, "Flux_tower_veg_indices_30m_11212021_v2.csv"), header = TRUE, na.strings = "NaN")
unique(data$Site)
#Rename the flux tower sites
data$site.name <- recode(.x=data$Site, 'US-SCg' ='Grassland US-SCg', 'US-SCf' = 'Oak Pine US-SCf', 'US-SCd' = 'Desert US-SCd', 'US-CZ3' = 'Mixed Conifer US-CZ3', 'US-SCw' = 'Pinyon US-SCw', 'US-CZ1' = 'Oak Pine US-CZ1', 'US-SCs' = 'Coastal Sage US-SCs',
'US-CZ4' = 'Subalpine US-CZ4', 'US-CZ2' = 'Ponderosa Pine US-CZ2', 'US-SCc' = 'Chaparral US-SCc')
#Format dates for the data
data$date <- as.Date(data$date)
data$year <- format(data$date, '%Y')
data$month <- format(data$date, '%m')
data$yday <- yday(data$date)
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10) %>%
group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = year, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
data %>% filter(month == 8 | month == 9 | month == 10) %>%
group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))
data %>% filter(month == 8 | month == 9 | month == 10) %>%
group_by(year, site.name)
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA_mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10 & LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA_mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
p7 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10)) +
geom_line(mapping = aes(x = year, y = NDMI_mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p7 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10)) +
geom_line(mapping = aes(x = date, y = NDMI_mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p8 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10)) +
geom_line(mapping = aes(x = date, y = NIRv_mean), color = 'black', size = 1) +
xlab('Year') + ylab('NIRv') + facet_wrap(~ site.name) + theme_bw()
p8
p8 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10) %>% group_by(site.name, date) %>% mutate(NIRv.mean = mean(NIRv_mean))) +
geom_line(mapping = aes(x = date, y = NIRv.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NIRv') + facet_wrap(~ site.name) + theme_bw()
p8
p8 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10) %>% group_by(site.name, year) %>% mutate(NIRv.mean = mean(NIRv_mean))) +
geom_line(mapping = aes(x = date, y = NIRv.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NIRv') + facet_wrap(~ site.name) + theme_bw()
p8
p7 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10 )%>%
group_by(site.name, year) %>% mutate(NDMI.mean = mean(NDMI_mean))) +
geom_line(mapping = aes(x = date, y = NDMI.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(month == 6 | month == 7 | month == 8) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(month == 6 | month == 7 | month == 8) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10 & LMA_mean < 1) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10 & LMA_mean < 1 & LMA_mean > -1) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10 & LMA_mean < 1 & LMA_mean > -1) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab('LMA') + facet_wrap(~ site.name) + theme_bw()
p6
ggsave(filename = 'Fig6_Landsat_LMA_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p7 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10 )%>%
group_by(site.name, year) %>% mutate(NDMI.mean = mean(NDMI_mean))) +
geom_line(mapping = aes(x = date, y = NDMI.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
ggsave(filename = 'Fig7_Landsat_NDMI_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p8 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10) %>%
group_by(site.name, year) %>% mutate(NIRv.mean = mean(NIRv_mean))) +
geom_line(mapping = aes(x = date, y = NIRv.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NIRv') + facet_wrap(~ site.name) + theme_bw()
p8
ggsave(filename = 'Fig8_Landsat_NIRv_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p6 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10 & LMA_mean < 1 & LMA_mean > -1) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
ggsave(filename = 'Fig6_Landsat_LMA_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p6 <- ggplot(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1)
& (Site == "US-SCf" | Site == "US-CZ1" | Site == "US-CZ2" | Site == "US-CZ3" |
Site == "US-CZ4" | Site == "US-SCw")) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1)) %>%
# & (Site == "US-SCf" | Site == "US-CZ1" | Site == "US-CZ2" | Site == "US-CZ3" |
#    Site == "US-CZ4" | Site == "US-SCw")) %>%
group_by(site.name, year) %>% mutate(LMA.mean = mean(LMA_mean))) + #& LMA_mean < 1 & LMA_mean > -1)) + #%>%
#group_by(year, site.name) %>% mutate(LMA.mean = mean(LMA_mean))) +
geom_line(mapping = aes(x = date, y = LMA.mean), color = 'black', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
