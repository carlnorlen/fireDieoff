x = INVYR, fill = tree_type), alpha = 0.2) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme_bw() +
theme(legend.position = 'none') +
xlab('Year') + ylab(expression('Density (trees ha'^-1*')'))
p6
f3 <- ggarrange(p4, p5, p6, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f3
live.pine <- all %>% filter(STATUSCD == 1 & tree_type %in% c('pine', 'fir')) %>%
group_by(INVYR, PLOT, COMMON_NAME, .drop = FALSE) %>%
summarize(count.live = n(), tpa.live = sum(count),
basal_area.live = sum(basal_area), STDAGE = median(STDAGE))
live.pine
#There is a slightly different result when using INVYR instead of MORTYR to calculate annual mortality
dead.pine <- all %>% filter(STATUSCD == 2 & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019") & tree_type %in% c('pine', 'fir')) %>%
group_by(PLOT, INVYR, COMMON_NAME, .drop = FALSE) %>%
summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
dead.pine
join.pine <- left_join(live.pine, dead.pine, by = c('PLOT', 'INVYR', 'COMMON_NAME'))
#Replace the NAs with 0s
join.pine <- join.pine %>% dplyr::mutate(basal_area.dead = replace(basal_area.dead, is.na(basal_area.dead), 0),
count.dead = replace(count.dead, is.na(count.dead), 0),
tpa.dead = replace(tpa.dead, is.na(tpa.dead), 0)
) %>% group_by(INVYR, PLOT) %>%
fill(STDAGE, .direction = c("up"))
# join
# summary(join)
#Add the total basal area calculations
join.pine$count.all <- join.pine$count.live + join.pine$count.dead
join.pine$tpa.all <- join.pine$tpa.live + join.pine$tpa.dead
join.pine$basal_area.all <- join.pine$basal_area.live + join.pine$basal_area.dead
join.pine$basal_area.dead.pct <- join.pine$basal_area.dead / join.pine$basal_area.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join.pine <- join.pine %>% dplyr::mutate(basal_area.dead.pct = replace(basal_area.dead.pct, is.na(basal_area.dead.pct), 0))
join.pine$tpa.dead.pct <- joi.pinen$tpa.dead / join.pine$tpa.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join.pine <- join.pine %>% dplyr::mutate(tpa.dead.pct = replace(tpa.dead.pct, is.na(tpa.dead.pct), 0))
join.pine$tpa.dead.pct <- join.pinen$tpa.dead / join.pine$tpa.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join.pine <- join.pine %>% dplyr::mutate(tpa.dead.pct = replace(tpa.dead.pct, is.na(tpa.dead.pct), 0))
join.pine$tpa.dead.pct <- join.pine$tpa.dead / join.pine$tpa.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join.pine <- join.pine %>% dplyr::mutate(tpa.dead.pct = replace(tpa.dead.pct, is.na(tpa.dead.pct), 0))
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join %>% ungroup() %>% #filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join %>% ungroup() %>% #filter(COMMON_NAME %in% c('pine', 'fir', 'oak', 'cedar')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>% #filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join.pine %>% ungroup() %>% #filter(COMMON_NAME %in% c('pine', 'fir', 'oak', 'cedar')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>% #filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join.pine %>% ungroup() %>% #filter(COMMON_NAME %in% c('pine', 'fir', 'oak', 'cedar')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>% filter(COMMON_NAME %in% c('ponderosa pine', 'singleleaf pinyon', 'sugar pine', 'California red fir', 'white fir', 'western white pine')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join.pine %>% ungroup() %>% filter(COMMON_NAME %in% c('ponderosa pine', 'singleleaf pinyon', 'sugar pine', 'California red fir', 'white fir', 'western white pine')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>% #filter(COMMON_NAME %in% c('ponderosa pine', 'singleleaf pinyon', 'sugar pine', 'California red fir', 'white fir')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
# geom_ribbon(data = join.pine %>% ungroup() %>% filter(COMMON_NAME %in% c('ponderosa pine', 'singleleaf pinyon', 'sugar pine', 'California red fir', 'white fir')) %>%
#               group_by(INVYR, COMMON_NAME) %>%
#               summarize(BA.dead = mean(basal_area.dead),
#                         BA.dead.sd = sd(basal_area.dead), BA.n = n()),
#             mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>% filter(COMMON_NAME %in% c('ponderosa pine', 'singleleaf pinyon', 'California red fir', 'white fir', 'Douglas-fir', 'Jeffrey pine')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
# geom_ribbon(data = join.pine %>% ungroup() %>% filter(COMMON_NAME %in% c('ponderosa pine', 'singleleaf pinyon', 'sugar pine', 'California red fir', 'white fir')) %>%
#               group_by(INVYR, COMMON_NAME) %>%
#               summarize(BA.dead = mean(basal_area.dead),
#                         BA.dead.sd = sd(basal_area.dead), BA.n = n()),
#             mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>% #filter(COMMON_NAME %in% c('ponderosa pine', 'singleleaf pinyon', 'California red fir', 'white fir', 'Douglas-fir', 'Jeffrey pine')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
# geom_ribbon(data = join.pine %>% ungroup() %>% filter(COMMON_NAME %in% c('ponderosa pine', 'singleleaf pinyon', 'sugar pine', 'California red fir', 'white fir')) %>%
#               group_by(INVYR, COMMON_NAME) %>%
#               summarize(BA.dead = mean(basal_area.dead),
#                         BA.dead.sd = sd(basal_area.dead), BA.n = n()),
#             mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
join.pine %>% filter(INVYR %in% c(2013,2014,2015,2016,2017,2018,2019)) %>% group_by(COMMON_NAME) %>% summarize(mortality = mean(basal_area.dead.pct))
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>% filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
# geom_ribbon(data = join.pine %>% ungroup() %>% filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir')) %>%
#               group_by(INVYR, COMMON_NAME) %>%
#               summarize(BA.dead = mean(basal_area.dead),
#                         BA.dead.sd = sd(basal_area.dead), BA.n = n()),
#             mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p1
join.pine %>% filter(INVYR %in% c(2013,2014,2015,2016,2017,2018,2019)) %>% group_by(COMMON_NAME) %>% summarize(mortality = mean(basal_area.dead.pct))
p2 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar')) %>%
group_by(INVYR, tree_type) %>% summarize(BA.dead.pct.mean = mean(basal_area.dead.pct) * 100, BA.n = n()),
mapping = aes(x = INVYR, y = BA.dead.pct.mean, color = tree_type, linetype = tree_type),  size = 1) +
#The error bars
geom_ribbon(data = join %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar')) %>%
group_by(INVYR, tree_type) %>%
summarize(BA.dead.pct.mean = mean(basal_area.dead.pct) * 100,
BA.dead.pct.sd = sd(basal_area.dead.pct) * 100,
BA.n = n()),
mapping = aes(ymin=BA.dead.pct.mean - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct.mean + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = INVYR, fill = tree_type), alpha = 0.2) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme_bw() +
theme(legend.position = 'none', axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab('Mortality (%)')
p2
p20 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, tree_type) %>% summarize(BA.dead.pct.mean = mean(basal_area.dead.pct) * 100, BA.n = n()),
mapping = aes(x = INVYR, y = BA.dead.pct.mean, color = tree_type, linetype = tree_type),  size = 1) +
#The error bars
geom_ribbon(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, tree_type) %>%
summarize(BA.dead.pct.mean = mean(basal_area.dead.pct) * 100,
BA.dead.pct.sd = sd(basal_area.dead.pct) * 100,
BA.n = n()),
mapping = aes(ymin=BA.dead.pct.mean - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct.mean + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = INVYR, fill = tree_type), alpha = 0.2) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme_bw() +
theme(legend.position = 'none', axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab('Mortality (%)')
p20
p20 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead.pct.mean = mean(basal_area.dead.pct) * 100, BA.n = n()),
mapping = aes(x = INVYR, y = BA.dead.pct.mean, color = COMMON_NAME, linetype = COMMON_NAME),  size = 1) +
#The error bars
geom_ribbon(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead.pct.mean = mean(basal_area.dead.pct) * 100,
BA.dead.pct.sd = sd(basal_area.dead.pct) * 100,
BA.n = n()),
mapping = aes(ymin=BA.dead.pct.mean - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct.mean + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME), alpha = 0.2) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme_bw() +
theme(legend.position = 'none', axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab('Mortality (%)')
p20
p21 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%               group_by(INVYR, COMMON_NAME) %>% summarize(BA.all = mean(basal_area.all), BA.n = n()),
mapping = aes(x = INVYR, y = BA.all, color = COMMON_NAME, linetype = COMMON_NAME),  size = 1) +
#The error bars
geom_ribbon(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%                 group_by(INVYR, COMMON_NAME) %>%
summarize(BA.mean = mean(basal_area.all),
BA.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(ymin=BA.mean - 1.96*(BA.sd / sqrt(BA.n)),
ymax=BA.mean + 1.96*(BA.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME), alpha = 0.2) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme_bw() +
theme(legend.position = 'none') +
xlab('Year') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p21
f10 <- ggarrange(p19, p20, p21, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f10
ggsave(filename = 'Fig13_pine_fir_bySpecies_FIA_mortality_density_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
p19 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p19
f10 <- ggarrange(p19, p20, p21, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f10
ggsave(filename = 'Fig13_pine_fir_bySpecies_FIA_mortality_density_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
#Set working directory
#setwd("/C/Users/Carl/mystuff/Goulden_Lab/Forest_Dieback/dieback/figure_set/field_data")
#cd /C/Users/Carl/mystuff/Goulden_Lab/Forest_Dieback/dieback/figure_set/field_data
#cd /C/Users/can02/mystuff/fireDieoff/FIA
#Command for calling the script in the command line: R < stand_age_dieoff.r --vanilla
#INstalling packages: install.packages('RColorBrewer',repo='https://cran.cnr.berkeley.edu/')
# setwd('C:/Users/can02/mystuff/fireDieoff/final_figures/fia')
setwd('C:/Users/Carl/mystuff/fireDieoff/final_figures/fia')
ggsave(filename = 'Fig13_pine_fir_bySpecies_FIA_mortality_density_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
p19 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
guides(fill=guide_legend(ncol=2)) +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p19
p19 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
guides(color=guide_legend(ncol=2)) +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p19
f10 <- ggarrange(p19, p20, p21, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f10
ggsave(filename = 'Fig13_pine_fir_bySpecies_FIA_mortality_density_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
p19 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = COMMON_NAME, linetype = COMMON_NAME), size = 1) +
#95% CI Die-off
geom_ribbon(data = join.pine %>% ungroup() %>%
filter(COMMON_NAME %in% c('ponderosa pine', 'sugar pine', 'California red fir', 'white fir', 'western white pine', 'Jeffrey pine', 'lodgepole pine', 'singleleaf pinyon')) %>%
group_by(INVYR, COMMON_NAME) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = COMMON_NAME, linetype = COMMON_NAME), alpha = 0.2) +
theme_bw() +
guides(color=guide_legend(ncol=2)) +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.6), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_viridis_d(name = "Tree\nSpecies") +
scale_fill_viridis_d(name = "Tree\nSpecies") +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p19
f10 <- ggarrange(p19, p20, p21, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f10
ggsave(filename = 'Fig13_pine_fir_bySpecies_FIA_mortality_density_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
