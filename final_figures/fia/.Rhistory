mapping = aes(y = BA.dead.pct, ymin=BA.dead.pct - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = tree_type, color = tree_type)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab('Mortality (%)')
p8
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)), mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1, position = 'dodge') +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type, position = 'dodge')) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1, position = position_dodge()) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type, position = position_dodge())) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type, position = position_dodge(width = 0.90))) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
p8 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead.pct = mean(basal_area.dead.pct)*100),
mapping = aes(x = tree_type, y = BA.dead.pct, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead.pct = mean(basal_area.dead.pct)*100,
BA.dead.pct.sd = sd(basal_area.dead.pct)*100, BA.n = n()),
mapping = aes(y = BA.dead.pct, ymin=BA.dead.pct - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = tree_type, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab('Mortality (%)')
p8
p8 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead.pct = mean(basal_area.dead.pct)*100),
mapping = aes(x = disturb.bin, y = BA.dead.pct, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead.pct = mean(basal_area.dead.pct)*100,
BA.dead.pct.sd = sd(basal_area.dead.pct)*100, BA.n = n()),
mapping = aes(y = BA.dead.pct, ymin=BA.dead.pct - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab('Mortality (%)')
p8
p9 <- ggplot() +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.all, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.all = mean(basal_area.dead),
BA.all.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p9
p9 <- ggplot() +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.all, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p9
p9 <- ggplot() +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.all, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_text(size = 10), axis.text.x = element_text(size = 8)) + #facet_grid(. ~ disturb.bin) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p9
f3 <- ggarrange(p7, p8, p9, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f3
ggsave(filename = 'Fig17_FIA_bySpecies_fire_mortality_BA_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.25, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
# scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
p8 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead.pct = mean(basal_area.dead.pct)*100),
mapping = aes(x = disturb.bin, y = BA.dead.pct, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead.pct = mean(basal_area.dead.pct)*100,
BA.dead.pct.sd = sd(basal_area.dead.pct)*100, BA.n = n()),
mapping = aes(y = BA.dead.pct, ymin=BA.dead.pct - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(legend.position = 'none', axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Disturbance Type') + ylab('Mortality (%)')
p8
p9 <- ggplot() +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.all, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(legend.position = 'none', axis.text.x = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), axis.text.y = element_text(size = 8)) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p9
f3 <- ggarrange(p7, p8, p9, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f3
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.8, 0.6), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
# scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
f3 <- ggarrange(p7, p8, p9, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f3
ggsave(filename = 'Fig17_FIA_bySpecies_fire_mortality_BA_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
p8 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead.pct = mean(basal_area.dead.pct)*100),
mapping = aes(x = disturb.bin, y = BA.dead.pct, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead.pct = mean(basal_area.dead.pct)*100,
BA.dead.pct.sd = sd(basal_area.dead.pct)*100, BA.n = n()),
mapping = aes(y = BA.dead.pct, ymin=BA.dead.pct - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
# scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme(legend.position = 'none', axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Disturbance Type') + ylab('Mortality (%)')
p8
p9 <- ggplot() +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.all, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
# scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme(legend.position = 'none', axis.text.x = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), axis.text.y = element_text(size = 8)) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p9
f3 <- ggarrange(p7, p8, p9, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f3
p7 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = tree_type), size = 1, position = position_dodge(width = 0.90)) +
#95% CI Die-of
geom_errorbar(data = join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & tree_type %in% c('pine', 'fir', 'oak')) %>%
group_by(disturb.bin, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = tree_type), position = position_dodge(width = 0.90)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.85, 0.7), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
# scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p7
f3 <- ggarrange(p7, p8, p9, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f3
ggsave(filename = 'Fig17_FIA_bySpecies_fire_mortality_BA_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
p4 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.sp %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(INVYR, tree_type) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = tree_type, linetype = tree_type), linewidth = 1) +
#95% CI Die-off
geom_ribbon(data = join.sp %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(INVYR, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = tree_type, linetype = tree_type), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.15, 0.65), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p4
p5 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join.sp %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(INVYR, tree_type) %>% summarize(BA.dead.pct.mean = mean(basal_area.dead.pct) * 100, BA.n = n()),
mapping = aes(x = INVYR, y = BA.dead.pct.mean, color = tree_type, linetype = tree_type),  linewidth = 1) +
#The error bars
geom_ribbon(data = join.sp %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(INVYR, tree_type) %>%
summarize(BA.dead.pct.mean = mean(basal_area.dead.pct) * 100,
BA.dead.pct.sd = sd(basal_area.dead.pct) * 100,
BA.n = n()),
mapping = aes(ymin=BA.dead.pct.mean - 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
ymax=BA.dead.pct.mean + 1.96*(BA.dead.pct.sd / sqrt(BA.n)),
x = INVYR, fill = tree_type), alpha = 0.2) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme_bw() +
theme(legend.position = 'none', axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab('Mortality (%)')
p5
# join %>% filter(STDAGE <= 10) %>% count()
p6 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join.sp %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(INVYR, tree_type) %>% summarize(BA.all = mean(basal_area.all), BA.n = n()),
mapping = aes(x = INVYR, y = BA.all, color = tree_type, linetype = tree_type),  linewidth = 1) +
#The error bars
geom_ribbon(data = join.sp %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(INVYR, tree_type) %>%
summarize(BA.mean = mean(basal_area.all),
BA.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(ymin=BA.mean - 1.96*(BA.sd / sqrt(BA.n)),
ymax=BA.mean + 1.96*(BA.sd / sqrt(BA.n)),
x = INVYR, fill = tree_type), alpha = 0.2) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
theme_bw() +
theme(legend.position = 'none') +
xlab('Year') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p6
f3 <- ggarrange(p4, p5, p6, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f3
ggsave(filename = 'Fig16_FIA_bySpecies_fire_mortality_BA_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
p4 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_line(data = join.sp %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(INVYR, tree_type) %>% summarize(BA.dead = mean(basal_area.dead)),
mapping = aes(x = INVYR, y = BA.dead, color = tree_type, linetype = tree_type), linewidth = 1) +
#95% CI Die-off
geom_ribbon(data = join.sp %>% ungroup() %>% filter(tree_type %in% c('pine', 'fir', 'oak', 'cedar', 'juniper')) %>%
group_by(INVYR, tree_type) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = INVYR, fill = tree_type, linetype = tree_type), alpha = 0.2) +
theme_bw() +
theme(axis.text.x = element_blank(), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.15, 0.62), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.y = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_fill_brewer(name = "Tree\nSpecies", palette = 'Dark2') +
scale_linetype_discrete(name = "Tree\nSpecies") +
# scale_fill_viridis_d("Tree\nSpecies", option = 'B') +
# scale_color_viridis_d("Tree\nSpecies", option = 'B') +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Year') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p4
f3 <- ggarrange(p4, p5, p6, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)'))
f3
ggsave(filename = 'Fig17_FIA_bySpecies_fire_mortality_BA_time_series.png', height=18, width= 10, units = 'cm', dpi=900)
