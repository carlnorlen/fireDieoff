frap$year <- frap$YEAR_
frap$Area.sf <- st_area(frap) #m^2 units
#Add date to FRAP Rx Burn
rxburn <- st_transform(rxburn, frap.crs)
rxburn$fire.date <- as.Date(rxburn$START_DATE)
rxburn$year <- rxburn$YEAR_  #format(rxburn$fire.date, '%Y')
rxburn$Area.sf <- st_area(rxburn) #m^2 units
rxburn$valid <- sf::st_is_valid(rxburn) #True or False
#Add date to Fire Severity data
fire.sev <- st_transform(fire.sev, frap.crs)
fire.sev$Area.sf <- st_area(fire.sev)
fire.sev$Area.sf %>% as.numeric()
#Get FRAP polygons that touch the South Sierra USFS Regions
frap.north.sierra <- st_join(frap[frap$valid == TRUE, ], north.sierra.sf)
# frap.north.sierra
frap.south.sierra <- st_intersection(frap[frap$valid == TRUE, ], south.sierra.sf)
#Get the prescribed burn polygons in the South Sierra USFS Regions
rxburn.south.sierra <- st_intersection(rxburn[rxburn$valid == TRUE, ], south.sierra.sf)
rxburn.north.sierra <- st_join(rxburn[rxburn$valid == TRUE, ], north.sierra.sf)
#Join the Fire Severity and South Sierra Region
fire.sev.south.sierra <- st_join(fire.sev, south.sierra.sf)
fire.sev.north.sierra <- st_join(fire.sev, north.sierra.sf)
p1 <- ggplot() +
coord_sf() +
theme_bw() +
#Add the California perimeter
geom_sf(data = ca_20m, color = 'black', alpha = 0.0, size = 0.5) +
#Add the South Sierra Perimeter
geom_sf(data = south.sierra.sf,  color='black', fill = 'black', alpha = 1, size = 0.1) +
#Add a scale bar
annotation_scale(location = "bl", height = unit(0.1, "cm"), width_hint = 0.2) +
#Add a North Arrow
annotation_north_arrow(location = "tr", which_north = "true",
height = unit(1, "cm"), width = unit(1, "cm"),
pad_x = unit(0.1, "cm"), pad_y = unit(0.1, "cm"),
style = north_arrow_minimal) + theme_bw() + guides(fill = guide_legend(title.position = "top"))
p1
cols <- c("Wild"="black", "Prescribed" = "gray")
lines <- c("Wild" = "dashed", "Prescribed" = "solid")
#Create a time series of FRAP burned area
#Some issue with the labels
#It doesn't seem to be actually filtering by the ecoregion.
p2 <- ggplot() +
#Line of total FRAP burned area in the South Sierra
geom_line(data = as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010, ]) %>% #) %>% #
group_by(year, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area / 10000, color = "Wild", linetype = "Wild"), size = 1) +  #, color = 'South Wildfire', linetype = 'South Wildfire'), size = 1) +
#Line of total FRAP burned area in the North Sierra
# geom_line(data = as.data.frame(frap.north.sierra[frap.north.sierra$year >= 1920 & frap.north.sierra$year <= 2010, ]) %>%
#             group_by(year, .groups = 'keep') %>% summarize(Area = sum(GIS_ACRES)),
#           mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area * 1/2.471), size = 1, color = 'gray') +  #, color = 'North Wildfire', linetype = 'North Wildfire'), size = 1) +
#Line of total RxBurn burned area in the South Sierra
geom_line(data = as.data.frame(rxburn.south.sierra[rxburn.south.sierra$year >= 1921 & rxburn.south.sierra$year <= 2010, ]) %>% #) %>% #
group_by(year, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area /10000, color = "Prescribed", linetype = "Prescribed"), size = 1) +
# #Line of total RxBurn burned area in the North Sierra
# geom_line(data = as.data.frame(rxburn.north.sierra[rxburn.north.sierra$year >= 1920 & rxburn.north.sierra$year <= 2010, ]) %>%
#             group_by(year, .groups = 'keep') %>% summarize(Area = sum(GIS_ACRES)),
#           mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area * 1/2.471, color = 'North RxBurn', linetype = 'North RxBurn'), size = 1) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6), axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_colour_manual(name="Fire Type (FRAP)",values=cols, aesthetics = 'color') +
scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('FRAP Burned Area (ha)') + xlab(NULL)
p2
p2 <- ggplot() +
#Line of total FRAP burned area in the South Sierra
geom_line(data = as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010, ]) %>% #) %>% #
group_by(year, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area / 10000, color = "Wild", linetype = "Wild"), size = 1) +  #, color = 'South Wildfire', linetype = 'South Wildfire'), size = 1) +
#Line of total FRAP burned area in the North Sierra
# geom_line(data = as.data.frame(frap.north.sierra[frap.north.sierra$year >= 1920 & frap.north.sierra$year <= 2010, ]) %>%
#             group_by(year, .groups = 'keep') %>% summarize(Area = sum(GIS_ACRES)),
#           mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area * 1/2.471), size = 1, color = 'gray') +  #, color = 'North Wildfire', linetype = 'North Wildfire'), size = 1) +
#Line of total RxBurn burned area in the South Sierra
geom_line(data = as.data.frame(rxburn.south.sierra[rxburn.south.sierra$year >= 1986 & rxburn.south.sierra$year <= 2010, ]) %>% #) %>% #
group_by(year, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area /10000, color = "Prescribed", linetype = "Prescribed"), size = 1) +
# #Line of total RxBurn burned area in the North Sierra
# geom_line(data = as.data.frame(rxburn.north.sierra[rxburn.north.sierra$year >= 1920 & rxburn.north.sierra$year <= 2010, ]) %>%
#             group_by(year, .groups = 'keep') %>% summarize(Area = sum(GIS_ACRES)),
#           mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area * 1/2.471, color = 'North RxBurn', linetype = 'North RxBurn'), size = 1) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6), axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_colour_manual(name="Fire Type (FRAP)",values=cols, aesthetics = 'color') +
scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
ylab('FRAP Burned Area (ha)') + xlab(NULL)
p2
p2 <- ggplot() +
#Line of total FRAP burned area in the South Sierra
geom_line(data = as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010, ]) %>% #) %>% #
group_by(year, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area / 10000, color = "Wild", linetype = "Wild"), size = 1) +  #, color = 'South Wildfire', linetype = 'South Wildfire'), size = 1) +
#Line of total FRAP burned area in the North Sierra
# geom_line(data = as.data.frame(frap.north.sierra[frap.north.sierra$year >= 1920 & frap.north.sierra$year <= 2010, ]) %>%
#             group_by(year, .groups = 'keep') %>% summarize(Area = sum(GIS_ACRES)),
#           mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area * 1/2.471), size = 1, color = 'gray') +  #, color = 'North Wildfire', linetype = 'North Wildfire'), size = 1) +
#Line of total RxBurn burned area in the South Sierra
geom_line(data = as.data.frame(rxburn.south.sierra[rxburn.south.sierra$year >= 1986 & rxburn.south.sierra$year <= 2010, ]) %>% #) %>% #
group_by(year, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area /10000, color = "Prescribed", linetype = "Prescribed"), size = 1) +
# #Line of total RxBurn burned area in the North Sierra
# geom_line(data = as.data.frame(rxburn.north.sierra[rxburn.north.sierra$year >= 1920 & rxburn.north.sierra$year <= 2010, ]) %>%
#             group_by(year, .groups = 'keep') %>% summarize(Area = sum(GIS_ACRES)),
#           mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = Area * 1/2.471, color = 'North RxBurn', linetype = 'North RxBurn'), size = 1) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6), axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_colour_manual(name="Fire Type",values=cols, aesthetics = 'color') +
scale_linetype_manual(name="Fire Type", values = lines) +
ylab('Burned Area (ha)') + xlab(NULL)
p2
p3 <- ggplot() +
#Line of total FRAP burned area in the South Sierra
geom_line(data = as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & Area.sf >= 90000, ]) %>% #& frap.south.sierra$Shape_Area >= 900000
group_by(year, .groups = 'keep') %>% summarize(count = n()),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = count, color = "Wild", linetype = "Wild"), size = 1) +  #, color = 'South Wildfire', linetype = 'South Wildfire'), size = 1) +
#Line of total RxBurn burned area in the South Sierra
geom_line(data = as.data.frame(rxburn.south.sierra[rxburn.south.sierra$year >= 1986 & rxburn.south.sierra$year <= 2010 & Area.sf >= 90000, ]) %>% #& rxburn.south.sierra$Shape_Area >= 900000
group_by(year, .groups = 'keep') %>% summarize(count = n()),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = count, color = "Prescribed", linetype = "Prescribed"), size = 1) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = 'null', legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6), axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10)) + #ylim(0, 20) +
scale_colour_manual(name="Fire Type (FRAP)",values=cols, aesthetics = 'color') +
scale_linetype_manual(name="Fire Type", values = lines) +
ylab('Number of Fires (>= 9 ha)') + xlab('Year')
p3
p3 <- ggplot() +
#Line of total FRAP burned area in the South Sierra
geom_line(data = as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= 90000, ]) %>% #& frap.south.sierra$Shape_Area >= 900000
group_by(year, .groups = 'keep') %>% summarize(count = n()),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = count, color = "Wild", linetype = "Wild"), size = 1) +  #, color = 'South Wildfire', linetype = 'South Wildfire'), size = 1) +
#Line of total RxBurn burned area in the South Sierra
geom_line(data = as.data.frame(rxburn.south.sierra[rxburn.south.sierra$year >= 1986 & rxburn.south.sierra$year <= 2010 & rxburn.south.sierra$Area.sf >= 90000, ]) %>% #& rxburn.south.sierra$Shape_Area >= 900000
group_by(year, .groups = 'keep') %>% summarize(count = n()),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = count, color = "Prescribed", linetype = "Prescribed"), size = 1) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = 'null', legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6), axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10)) + #ylim(0, 20) +
scale_colour_manual(name="Fire Type (FRAP)",values=cols, aesthetics = 'color') +
scale_linetype_manual(name="Fire Type", values = lines) +
ylab('Number of Fires (>= 9 ha)') + xlab('Year')
p3
as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= 90000, ]
as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= 90000, ])
summary(frap.south.sierra)
frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= 90000, ]
rap.south.sierra$Area.sf
frap.south.sierra$Area.sf
frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= as.units(90000,units::parse_unit("m^2"))
library(units)
frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= as.units(90000,units::parse_unit("m^2"))
frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= as.units(90000,units::parse_unit("m^2")), ]
as.units(90000,units::parse_unit("m^2"))
as_units(90000,"m^2")
frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= as_units(90000,"m^2"), ]
p3 <- ggplot() +
#Line of total FRAP burned area in the South Sierra
geom_line(data = as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= as_units(90000,"m^2"), ]) %>% #& frap.south.sierra$Shape_Area >= 900000
group_by(year, .groups = 'keep') %>% summarize(count = n()),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = count, color = "Wild", linetype = "Wild"), size = 1) +  #, color = 'South Wildfire', linetype = 'South Wildfire'), size = 1) +
#Line of total RxBurn burned area in the South Sierra
geom_line(data = as.data.frame(rxburn.south.sierra[rxburn.south.sierra$year >= 1986 & rxburn.south.sierra$year <= 2010 & rxburn.south.sierra$Area.sf >= as_units(90000,"m^2"), ]) %>% #& rxburn.south.sierra$Shape_Area >= 900000
group_by(year, .groups = 'keep') %>% summarize(count = n()),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = count, color = "Prescribed", linetype = "Prescribed"), size = 1) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = 'null', legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6), axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10)) + #ylim(0, 20) +
scale_colour_manual(name="Fire Type (FRAP)",values=cols, aesthetics = 'color') +
scale_linetype_manual(name="Fire Type", values = lines) +
ylab('Number of Fires (>= 9 ha)') + xlab('Year')
p3
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Area.sf)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Area.sf)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * as_units(1/10000, "m^2"),
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Area.sf)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area / as_units(10000, "m^2"),
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255)
# summary(frap.south.sierra)
# frap.south.sierra$Area.sf
#Create a time series of Fire Severity burned area
summary(fire.sev.south.sierra)
# summary(frap.south.sierra)
# frap.south.sierra$Area.sf
#Create a time series of Fire Severity burned area
fire.sev.south.sierra$Area.sf
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Shape_Area / 10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area / 10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
#Create a time series of FRAP burned area
#Some issue with the labels
#It doesn't seem to be actually filtering by the ecoregion.
summary(frap.south.sierra)
f1 <- ggarrange(p2, p3, ncol = 1, nrow = 2, common.legend = FALSE, heights = c(0.9, 1), align = "v", labels = c('a)', 'b)'))
f1
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255 & frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area / 10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255 & fire.sev.south.sierra$year >= 1986 & fire.sev.south.sierra$year <= 2010) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area / 10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
# summary(frap.south.sierra)
# frap.south.sierra$Area.sf
#Create a time series of Fire Severity burned area
fire.sev.south.sierra %>% summary()
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255 & fire.sev.south.sierra$FIRE_YEAR >= 1986 & fire.sev.south.sierra$FIRE_YEAR <= 2010) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area / 10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
f1 <- ggarrange(p2, p3, ncol = 1, nrow = 2, common.legend = FALSE, heights = c(0.9, 1), align = "v", labels = c('a)', 'b)'))
f1
ggsave(filename = 'Fig2_FRAP_time_series_South_Sierra.png', height=20, width=16, units = 'cm', dpi=900)
#Set the working directory
setwd('C:/Users/can02/mystuff/fireDieoff/final_figures/fire_trends')
ggsave(filename = 'Fig2_FRAP_time_series_South_Sierra.png', height=20, width=16, units = 'cm', dpi=900)
p1
ggsave(filename = 'Fig1_Ecoregion_map.png', height=12, width=9, units = 'cm', dpi=900)
p4 <- ggplot() +
#Line of total FRAP burned area in the South Sierra
geom_line(data = as.data.frame(frap.south.sierra[frap.south.sierra$year >= 1986 & frap.south.sierra$year <= 2010 & frap.south.sierra$Area.sf >= as_units(90000,"m^2"), ]) %>% #& frap.south.sierra$Shape_Area >= 900000
group_by(year, .groups = 'keep') %>% summarize(count = n()),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = count, color = "Wild", linetype = "Wild"), size = 1) +  #, color = 'South Wildfire', linetype = 'South Wildfire'), size = 1) +
#Line of total RxBurn burned area in the South Sierra
geom_line(data = as.data.frame(rxburn.south.sierra[rxburn.south.sierra$year >= 1986 & rxburn.south.sierra$year <= 2010 & rxburn.south.sierra$Area.sf >= as_units(90000,"m^2"), ]) %>% #& rxburn.south.sierra$Shape_Area >= 900000
group_by(year, .groups = 'keep') %>% summarize(count = n()),
mapping = aes(x = as.Date(as.character(year), format = "%Y"), y = count, color = "Prescribed", linetype = "Prescribed"), size = 1) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = 'null', legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6), axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10)) + #ylim(0, 20) +
scale_colour_manual(name="Fire Type (FRAP)",values=cols, aesthetics = 'color') +
scale_linetype_manual(name="Fire Type", values = lines) +
ylab('Number of Fires (>= 9 ha)') + xlab('Year')
p4
ggsave(filename = 'Fig3_USFS_Fire_Severity_time_series_South_Sierra.png', height=10, width=16, units = 'cm', dpi=900)
p1 <- ggplot() +
coord_sf() +
theme_bw() +
#Add the California perimeter
geom_sf(data = ca_20m %>% st_transform(c), color = 'black', alpha = 0.0, size = 0.5) +
#Add the South Sierra Perimeter
geom_sf(data = south.sierra.sf %>% st_transform(c),  color='black', fill = 'black', alpha = 1, size = 0.1) +
#Add a scale bar
annotation_scale(location = "bl", height = unit(0.1, "cm"), width_hint = 0.2) +
#Add a North Arrow
annotation_north_arrow(location = "tr", which_north = "true",
height = unit(1, "cm"), width = unit(1, "cm"),
pad_x = unit(0.1, "cm"), pad_y = unit(0.1, "cm"),
style = north_arrow_minimal) + theme_bw() + guides(fill = guide_legend(title.position = "top"))
p1
#Setting variable for ESPG 5070, proj4 crs
c <- crs("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs")
p1 <- ggplot() +
coord_sf() +
theme_bw() +
#Add the California perimeter
geom_sf(data = ca_20m %>% st_transform(c), color = 'black', alpha = 0.0, size = 0.5) +
#Add the South Sierra Perimeter
geom_sf(data = south.sierra.sf %>% st_transform(c),  color='black', fill = 'black', alpha = 1, size = 0.1) +
#Add a scale bar
annotation_scale(location = "bl", height = unit(0.1, "cm"), width_hint = 0.2) +
#Add a North Arrow
annotation_north_arrow(location = "tr", which_north = "true",
height = unit(1, "cm"), width = unit(1, "cm"),
pad_x = unit(0.1, "cm"), pad_y = unit(0.1, "cm"),
style = north_arrow_minimal) + theme_bw() + guides(fill = guide_legend(title.position = "top"))
p1
p1 | (p2 / p3)
f1 <- p1 | (p2 / p3)
f1
ggsave(filename = 'Fig1_South_Sierra_map_and_fire_areas.png', height=20, width=16, units = 'cm', dpi=900)
ggsave(filename = 'Fig1_South_Sierra_map_and_fire_areas.png', height=16, width=24, units = 'cm', dpi=900)
f1 <- p1 | (p2 / p3) + plot_annotation(tag_levels = 'a)')
f1
f1 <- p1 | (p2 / p3) + plot_annotation(tag_levels = 'a')
f1
f1 <- p1 | (p2 / p3) + plot_annotation(tag_levels = 'A')
f1
ggsave(filename = 'Fig1_South_Sierra_map_and_fire_areas.png', height=16, width=24, units = 'cm', dpi=900)
f1 + plot_annotation(tag_levels = 'a)')
f1 + plot_annotation(tag_levels = 'a')
f1 + plot_annotation(tag_levels = 'a.')
f1 + plot_annotation(tag_levels = 'a')
ggsave(filename = 'Fig1_South_Sierra_map_and_fire_areas.png', height=16, width=24, units = 'cm', dpi=900)
p3 <- ggplot() +
#Line of total USFS burned area in the South Sierra
geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255 & fire.sev.south.sierra$FIRE_YEAR >= 1986 & fire.sev.south.sierra$FIRE_YEAR <= 2010) %>%
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area / 10000,
color = as.factor(BURNSEV), linetype = as.factor(BURNSEV)), size = 1) +
#Line of total USFS burned area in the South Sierra
# geom_line(data = as.data.frame(fire.sev.south.sierra) %>% filter(!is.na(BURNSEV) & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, .groups = 'keep') %>% summarize(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000),
#           color = 'black', alpha = 0.4, size = 1.5) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.15, 0.7), legend.background = element_rect(colour = NA, fill = NA),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High'), aesthetics = 'color') +
scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
ylab('Burned Area (ha)') + xlab('Year')
p3
f1 <- p1 | (p2 / p3)
f1 + plot_annotation(tag_levels = 'a')
ggsave(filename = 'Fig1_South_Sierra_map_and_fire_areas.png', height=16, width=24, units = 'cm', dpi=900)
