# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#               dplyr::group_by(system.index) %>%
#               summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
#               method = 'lm', mapping = aes(x = stand.age, y = dTree)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#            dplyr::group_by(system.index) %>%
#            summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
#          mapping = aes(x = stand.age, y = dTree) ) +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age.grp = stand.age.grp[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age.grp * 10, y = dTree), size = 2) + ylim(-10, 5) +
geom_errorbar(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age.grp = stand.age.grp[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age.grp * 10, ymin = dTree - ((dTree.sd /sqrt(dTree.n))*1.96), ymax = dTree + ((dTree.sd /sqrt(dTree.n))*1.96)), size = 2) + ylim(-10, 5) +
xlab('Stand Age (10-year Bins') + ylab('Change in Tree Cover (%)') +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
p14 <- ggplot() +
#The full data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
# summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
# mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
# #The summarized data
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#               dplyr::group_by(system.index) %>%
#               summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
#               method = 'lm', mapping = aes(x = stand.age, y = dTree)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#            dplyr::group_by(system.index) %>%
#            summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
#          mapping = aes(x = stand.age, y = dTree) ) +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age.grp = stand.age.grp[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age.grp * 10, y = dTree), size = 2) +
geom_errorbar(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age.grp = stand.age.grp[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age.grp * 10, ymin = dTree - ((dTree.sd /sqrt(dTree.n))*1.96), ymax = dTree + ((dTree.sd /sqrt(dTree.n))*1.96)), size = 2) + ylim(-10, 5) +
xlab('Stand Age (10-year Bins') + ylab('Change in Tree Cover (%)') +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
p14 <- ggplot() +
#The full data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
# summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
# mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
# #The summarized data
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#               dplyr::group_by(system.index) %>%
#               summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
#               method = 'lm', mapping = aes(x = stand.age, y = dTree)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#            dplyr::group_by(system.index) %>%
#            summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
#          mapping = aes(x = stand.age, y = dTree) ) +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age.grp = stand.age.grp[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age.grp * 10, y = dTree), size = 2) +
geom_errorbar(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age.grp = stand.age.grp[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age.grp * 10, ymin = dTree - ((dTree.sd /sqrt(dTree.n))*1.96), ymax = dTree + ((dTree.sd /sqrt(dTree.n))*1.96)), width = 3) + ylim(-10, 5) +
xlab('Stand Age (10-year Bins') + ylab('Change in Tree Cover (%)') +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
p15 <- ggplot() +
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), size = 0.5, alpha = 0.3, color = 'gray') +
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            method = 'lm', mapping = aes(x = stand.age, y = tpa_max)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), color = 'blue') +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2017, 2018, 2019)], na.rm = TRUE), stand.age.grp = stand.age.grp[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(tpa_max = mean(tpa_max), tpa_max.n = n(), tpa_max.sd = sd(tpa_max)),
mapping = aes(x = stand.age.grp * 10, y = tpa_max), size = 2) +
p15
p15 <- ggplot() +
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), size = 0.5, alpha = 0.3, color = 'gray') +
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            method = 'lm', mapping = aes(x = stand.age, y = tpa_max)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), color = 'blue') +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2017, 2018, 2019)], na.rm = TRUE), stand.age.grp = stand.age.grp[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(tpa_max = mean(tpa_max), tpa_max.n = n(), tpa_max.sd = sd(tpa_max)),
mapping = aes(x = stand.age.grp * 10, y = tpa_max), size = 2) + theme_bw
p15
p15 <- ggplot() +
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), size = 0.5, alpha = 0.3, color = 'gray') +
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            method = 'lm', mapping = aes(x = stand.age, y = tpa_max)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), color = 'blue') +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2017, 2018, 2019)], na.rm = TRUE), stand.age.grp = stand.age.grp[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(tpa_max = mean(tpa_max), tpa_max.n = n(), tpa_max.sd = sd(tpa_max)),
mapping = aes(x = stand.age.grp * 10, y = tpa_max), size = 2) + theme_bw()
p15
p15 <- ggplot() +
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), size = 0.5, alpha = 0.3, color = 'gray') +
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            method = 'lm', mapping = aes(x = stand.age, y = tpa_max)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), color = 'blue') +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2017, 2018, 2019)], na.rm = TRUE), stand.age.grp = stand.age.grp[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(tpa_max = mean(tpa_max), tpa_max.n = n(), tpa_max.sd = sd(tpa_max)),
mapping = aes(x = stand.age.grp * 10, y = tpa_max), size = 2) + theme_bw() xlab('Stand Age (10-year Bins') + ylab('Mortality (trees/ha)') +
p15
ggsave(filename = 'Fig10_ADS_mortality_stand_age_wildfire_10pt_300m.png', height=16, width= 18, units = 'cm', dpi=900)
p15 <- ggplot() +
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), size = 0.5, alpha = 0.3, color = 'gray') +
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            method = 'lm', mapping = aes(x = stand.age, y = tpa_max)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), color = 'blue') +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2017, 2018, 2019)], na.rm = TRUE), stand.age.grp = stand.age.grp[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(tpa_max = mean(tpa_max), tpa_max.n = n(), tpa_max.sd = sd(tpa_max)),
mapping = aes(x = stand.age.grp * 10, y = tpa_max), size = 2) + theme_bw() + xlab('Stand Age (10-year Bins') + ylab('Mortality (trees/ha)') +
p15
ggsave(filename = 'Fig10_ADS_mortality_stand_age_wildfire_10pt_300m.png', height=16, width= 18, units = 'cm', dpi=900)
p16 <- ggplot(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index, fire.year.bin) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2015])) +
geom_point(mapping = aes(x = Tree, y = dTree), size = 0.5, alpha = 0.3, color = 'black') +
xlab('Tree Cover (%)') + ylab('dTree Cover (%)') +
theme_bw() + facet_grid(. ~ fire.year.bin)
p16
ggsave(filename = 'Fig11_dTree_Tree_frap_10pts_300m.png', height=16, width= 18, units = 'cm', dpi=900)
p17 <- ggplot(data = pixel.data %>% dplyr::filter(fire.year <= 2010 & fire.year >= 1920 ) %>% dplyr::group_by(system.index) %>% summarize(dTree = Tree_Cover[vi.year == 2017] - Tree_Cover[vi.year == 2015], Water_Stress = Water_Stress[vi.year == 2015], SPI48 = SPI48[vi.year == 2015], PrET.4yr = sum(PrET[vi.year %in% c(2012,2013,2014,2015)]), fire.year.bin = fire.year.bin[vi.year == 2010])) +
geom_point(mapping = aes(x = PrET.4yr, y =  Water_Stress, color = fire.year.bin), size = 1) +
geom_smooth(method = 'lm', mapping = aes(x = PrET.4yr, y = Water_Stress, color = fire.year.bin , linetype = fire.year.bin)) +
stat_cor(mapping = aes(x = PrET.4yr, y =  Water_Stress, color = fire.year.bin) ) +
theme_bw()
p17
p17 <- ggplot(data = pixel.data %>% dplyr::filter(fire.year <= 2010 & fire.year >= 1920 & stand.age > 0) %>% dplyr::group_by(system.index) %>% summarize(dTree = Tree_Cover[vi.year == 2017] - Tree_Cover[vi.year == 2015], Water_Stress = Water_Stress[vi.year == 2015], SPI48 = SPI48[vi.year == 2015], PrET.4yr = sum(PrET[vi.year %in% c(2012,2013,2014,2015)]), fire.year.bin = fire.year.bin[vi.year == 2010])) +
geom_point(mapping = aes(x = PrET.4yr, y =  Water_Stress), size = 1) +
geom_smooth(method = 'lm', mapping = aes(x = PrET.4yr, y = Water_Stress)) +
stat_cor(mapping = aes(x = PrET.4yr, y =  Water_Stress) ) + facet_wrap(. ~ fire.year.bin) +
theme_bw()
p17
ggsave(filename = 'Fig24_Water_Stress_PrET_correlation_10pt_frap_sample.png', height=16, width= 18, units = 'cm', dpi=900)
p15 <- ggplot() +
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), size = 0.5, alpha = 0.3, color = 'gray') +
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            method = 'lm', mapping = aes(x = stand.age, y = tpa_max)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), color = 'blue') +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2017, 2018, 2019)], na.rm = TRUE), stand.age.grp = stand.age.grp[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(tpa_max = mean(tpa_max), tpa_max.n = n(), tpa_max.sd = sd(tpa_max)),
mapping = aes(x = stand.age.grp * 10, y = tpa_max), size = 2) + theme_bw() + xlab('Stand Age (10-year Bins)') + ylab('Mortality (trees/ha)') +
p15
p15 <- ggplot() +
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), size = 0.5, alpha = 0.3, color = 'gray') +
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            method = 'lm', mapping = aes(x = stand.age, y = tpa_max)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), color = 'blue') +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2017, 2018, 2019)], na.rm = TRUE), stand.age.grp = stand.age.grp[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(tpa_max = mean(tpa_max), tpa_max.n = n(), tpa_max.sd = sd(tpa_max)),
mapping = aes(x = stand.age.grp * 10, y = tpa_max), size = 2) +
theme_bw() + xlab('Stand Age (10-year Bins)') + ylab('Mortality (trees/ha)') +
p15
ggsave(filename = 'Fig10_ADS_mortality_stand_age_wildfire_10pt_300m.png', height=16, width= 18, units = 'cm', dpi=900)
p14 <- ggplot() +
#The full data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
# summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
# mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
# #The summarized data
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#               dplyr::group_by(system.index) %>%
#               summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
#               method = 'lm', mapping = aes(x = stand.age, y = dTree)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
#            dplyr::group_by(system.index) %>%
#            summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]),
#          mapping = aes(x = stand.age, y = dTree) ) +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age.grp = stand.age.grp[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age.grp * 10, y = dTree), size = 2) +
geom_errorbar(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015]), stand.age.grp = stand.age.grp[vi.year == 2010], Water_Stress = Water_Stress[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age.grp * 10, ymin = dTree - ((dTree.sd /sqrt(dTree.n))*1.96), ymax = dTree + ((dTree.sd /sqrt(dTree.n))*1.96)), width = 3) +
ylim(-10, 5) +
xlab('Stand Age (10-year Bins') + ylab('Change in Tree Cover (%)') +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
ggsave(filename = 'Fig9_dTree_stand_age_wildfire_frap_10pt_sample_300m.png', height=16, width= 18, units = 'cm', dpi=900)
p15 <- ggplot() +
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), size = 0.5, alpha = 0.3, color = 'gray') +
# geom_smooth(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            method = 'lm', mapping = aes(x = stand.age, y = tpa_max)) +
# stat_cor(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1920) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019)], na.rm = TRUE), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
#            mapping = aes(x = stand.age, y = tpa_max), color = 'blue') +
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age > 2 & fire.year <= 2010 & fire.year >= 1920) %>%
dplyr::group_by(system.index) %>%
summarize(tpa_max = max(tpa_max[vi.year %in% c(2012, 2013, 2014, 2015, 2016, 2017, 2017, 2018, 2019)], na.rm = TRUE), stand.age.grp = stand.age.grp[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age.grp) %>%
summarize(tpa_max = mean(tpa_max), tpa_max.n = n(), tpa_max.sd = sd(tpa_max)),
mapping = aes(x = stand.age.grp * 10, y = tpa_max), size = 2) +
xlab('Stand Age (10-year Bins)') + ylab('Mortality (trees/ha)') + theme_bw()
p15
ggsave(filename = 'Fig10_ADS_mortality_stand_age_wildfire_10pt_300m.png', height=16, width= 18, units = 'cm', dpi=900)
p13 <- ggplot(data = pixel.data %>% dplyr::filter(fire.year <= 2010 & fire.year >= 1920 & stand.age > 2) %>% dplyr::group_by(system.index) %>%
summarize(dTree = Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015], Water_Stress = Water_Stress[vi.year == 2015], SPI48 = SPI48[vi.year == 2015], PrET.4yr = sum(PrET[vi.year %in% c(2012,2013,2014,2015)]), fire.year.bin = fire.year.bin[vi.year == 2010])) +
geom_bin2d(binwidth = c(25, 1), mapping = aes(x = PrET.4yr, y = dTree, group = ..count..)) +
scale_fill_gradient2(limits = c(0,250), breaks = c(0,50, 100, 150, 200, 250), midpoint = 125, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') + #
# geom_point(mapping = aes(x = Water_Stress, y = dTree), size = 1) +
geom_smooth(method = 'lm', mapping = aes(x = PrET.4yr, y = dTree), color = 'black', linetype = 'dashed', size = 2) +
stat_cor( mapping = aes(x = PrET.4yr, y = dTree)) + facet_wrap (. ~ fire.year.bin) +
theme_bw() + xlab('Four-year Pr-ET (mm/4yr)') + ylab('Change in Tree Cover (%)')
p13
p13 <- ggplot(data = pixel.data %>% dplyr::filter(fire.year <= 2010 & fire.year >= 1920 & stand.age > 2) %>% dplyr::group_by(system.index) %>%
summarize(dTree = Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015], Water_Stress = Water_Stress[vi.year == 2015], SPI48 = SPI48[vi.year == 2015], PrET.4yr = sum(PrET[vi.year %in% c(2012,2013,2014,2015)]), fire.year.bin = fire.year.bin[vi.year == 2010])) +
geom_bin2d(binwidth = c(50, 1), mapping = aes(x = PrET.4yr, y = dTree, group = ..count..)) +
scale_fill_gradient2(low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') + # limits = c(0,250), breaks = c(0,50, 100, 150, 200, 250), midpoint = 125,
# geom_point(mapping = aes(x = Water_Stress, y = dTree), size = 1) +
geom_smooth(method = 'lm', mapping = aes(x = PrET.4yr, y = dTree), color = 'black', linetype = 'dashed', size = 2) +
stat_cor( mapping = aes(x = PrET.4yr, y = dTree)) + facet_wrap (. ~ fire.year.bin) +
theme_bw() + xlab('Four-year Pr-ET (mm/4yr)') + ylab('Change in Tree Cover (%)')
p13
p13 <- ggplot(data = pixel.data %>% dplyr::filter(fire.year <= 2010 & fire.year >= 1920 & stand.age > 2) %>% dplyr::group_by(system.index) %>%
summarize(dTree = Tree_Cover[vi.year == 2019] - Tree_Cover[vi.year == 2015], Water_Stress = Water_Stress[vi.year == 2015], SPI48 = SPI48[vi.year == 2015], PrET.4yr = sum(PrET[vi.year %in% c(2012,2013,2014,2015)]), fire.year.bin = fire.year.bin[vi.year == 2010])) +
geom_bin2d(binwidth = c(50, 1), mapping = aes(x = PrET.4yr, y = dTree, group = ..count..)) +
scale_fill_gradient2(limits = c(0,20), breaks = c(0,5, 10, 15), midpoint = 10, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') + # limits = c(0,250), breaks = c(0,50, 100, 150, 200, 250), midpoint = 125,
# geom_point(mapping = aes(x = Water_Stress, y = dTree), size = 1) +
geom_smooth(method = 'lm', mapping = aes(x = PrET.4yr, y = dTree), color = 'black', linetype = 'dashed', size = 2) +
stat_cor( mapping = aes(x = PrET.4yr, y = dTree)) + facet_wrap (. ~ fire.year.bin) +
theme_bw() + xlab('Four-year Pr-ET (mm/4yr)') + ylab('Change in Tree Cover (%)')
p13
ggsave(filename = 'Fig8_PrET4yr_stand_age_frap_10pt_sample_300m.png', height=16, width= 18, units = 'cm', dpi=900)
p18 <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(Shrub_Cover) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(Shrub_Cover.mean = mean(GPP)), mapping = aes(x = stand.age, y = GPP.mean), size = 1) +
#Shrub Cover 95% CI
geom_ribbon(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(Shrub_Cover) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(GPP.mean = mean(GPP),
GPP.sd = sd(GPP), GPP.n = n()),
mapping = aes(ymin=GPP.mean - 1.96*(GPP.sd / sqrt(GPP.n)),
ymax=GPP.mean + 1.96*(GPP.sd / sqrt(GPP.n)),
x = stand.age), alpha = 0.3) +
#Create a Tree Cover line
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_colour_manual(name="Vegetation Type",values=cols, aesthetics = 'color') +
scale_fill_manual(values = fills) +
guides(fill = "none") +
ylab(expression('Cover (%)')) + xlab('Years Since Fire')
p18
pixel.data$GPP <- pixel.data$GPP_mean
p18 <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(Shrub_Cover) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(GPP.mean = mean(GPP)), mapping = aes(x = stand.age, y = GPP.mean), size = 1) +
#Shrub Cover 95% CI
geom_ribbon(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(Shrub_Cover) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(GPP.mean = mean(GPP),
GPP.sd = sd(GPP), GPP.n = n()),
mapping = aes(ymin=GPP.mean - 1.96*(GPP.sd / sqrt(GPP.n)),
ymax=GPP.mean + 1.96*(GPP.sd / sqrt(GPP.n)),
x = stand.age), alpha = 0.3) +
#Create a Tree Cover line
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_colour_manual(name="Vegetation Type",values=cols, aesthetics = 'color') +
scale_fill_manual(values = fills) +
guides(fill = "none") +
ylab(expression('Cover (%)')) + xlab('Years Since Fire')
p18
p18 <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(Shrub_Cover) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(GPP.mean = mean(GPP)), mapping = aes(x = stand.age, y = GPP.mean), size = 1) +
#Shrub Cover 95% CI
geom_ribbon(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(Shrub_Cover) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(GPP.mean = mean(GPP),
GPP.sd = sd(GPP), GPP.n = n()),
mapping = aes(ymin=GPP.mean - 1.96*(GPP.sd / sqrt(GPP.n)),
ymax=GPP.mean + 1.96*(GPP.sd / sqrt(GPP.n)),
x = stand.age), alpha = 0.3) +
#Create a Tree Cover line
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_colour_manual(name="Vegetation Type",values=cols, aesthetics = 'color') +
scale_fill_manual(values = fills) +
guides(fill = "none") +
ylab(expression('GPP (g/m^2/yr')) + xlab('Years Since Fire')
p18
p19 <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(AET) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(AET.mean = mean(AET)), mapping = aes(x = stand.age, y = AET.mean), size = 1) +
#Shrub Cover 95% CI
geom_ribbon(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(AET) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(AET.mean = mean(AET),
AET.sd = sd(AET), AET.n = n()),
mapping = aes(ymin=AET.mean - 1.96*(AET.sd / sqrt(AET.n)),
ymax=AET.mean + 1.96*(AET.sd / sqrt(AET.n)),
x = stand.age), alpha = 0.3) +
#Create a Tree Cover line
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_colour_manual(name="Vegetation Type",values=cols, aesthetics = 'color') +
scale_fill_manual(values = fills) +
guides(fill = "none") +
ylab(expression('AET (mm/yr')) + xlab('Years Since Fire')
p19
p18 <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(GPP) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(GPP.mean = mean(GPP)), mapping = aes(x = stand.age, y = GPP.mean), size = 1) +
#Shrub Cover 95% CI
geom_ribbon(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(GPP) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(GPP.mean = mean(GPP),
GPP.sd = sd(GPP), GPP.n = n()),
mapping = aes(ymin=GPP.mean - 1.96*(GPP.sd / sqrt(GPP.n)),
ymax=GPP.mean + 1.96*(GPP.sd / sqrt(GPP.n)),
x = stand.age), alpha = 0.3) +
#Create a Tree Cover line
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_colour_manual(name="Vegetation Type",values=cols, aesthetics = 'color') +
scale_fill_manual(values = fills) +
guides(fill = "none") +
ylab(expression('GPP (g/m^2/yr')) + xlab('Years Since Fire')
p18
p19 <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(AET) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(AET.mean = mean(AET)), mapping = aes(x = stand.age, y = AET.mean), size = 1) +
#Shrub Cover 95% CI
geom_ribbon(data = pixel.data %>%
filter(stand.age >= -10 & stand.age <= 85 & !is.na(AET) & vi.year <= 2014 & fire.year >= 1920 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(AET.mean = mean(AET),
AET.sd = sd(AET), AET.n = n()),
mapping = aes(ymin=AET.mean - 1.96*(AET.sd / sqrt(AET.n)),
ymax=AET.mean + 1.96*(AET.sd / sqrt(AET.n)),
x = stand.age), alpha = 0.3) +
#Create a Tree Cover line
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_colour_manual(name="Vegetation Type",values=cols, aesthetics = 'color') +
scale_fill_manual(values = fills) +
guides(fill = "none") +
ylab(expression('AET (mm/yr')) + xlab('Years Since Fire')
p19
f5 <- ggarrange(p18, p19, ncol = 1, nrow = 2, common.legend = FALSE, heights = c(0.9, 1), align = "v", labels = c('a)', 'b)'))
f5
#Save the data
#Save the data
ggsave(filename = 'Fig25_veg_cover_stand_age_10pt_300m_frap_perimeter.png', height=18, width= 20, units = 'cm', dpi=900)
