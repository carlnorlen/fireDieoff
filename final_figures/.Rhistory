# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev.clip %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>% #
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(area)),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Wild"), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev.clip %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>% #
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Wild"), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8) +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Wild"), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
frap.clip$type <- 'Wild'
rxburn.clip$type <- 'Prescribed'
#combined FRAP and Rx
frap.rxburn.clip <- dplry::bind.rows(frap.clip, rxburn.clip)
#combined FRAP and Rx
frap.rxburn.clip <- dplyr::bind.rows(frap.clip, rxburn.clip)
#combined FRAP and Rx
frap.rxburn.clip <- dplyr::bind_rows(frap.clip, rxburn.clip)
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = type), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = type), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
# scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
# lines <- c("Wild" = "dashed", "Prescribed" = "solid")
# summary(rxburn.clip)
# summary(frap.clip)
# summary(fire.sev.clip)
plot(frap.rxburn.clip)
# lines <- c("Wild" = "dashed", "Prescribed" = "solid")
# summary(rxburn.clip)
# summary(frap.clip)
# summary(fire.sev.clip)
summary(frap.rxburn.clip)
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = as.factor(type)), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
# scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = as.factor(type)), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
# scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
frap.clip <- frap.clip %>% add_column(type = 'Wild')
frap.clip <- frap.clip %>% mutate(type = 'Wild')
rxburn.clip %>% rxburn.clip %>% mutate(type = 'Prescribed')
rxburn.clip <- rxburn.clip %>% mutate(type = 'Prescribed')
#combined FRAP and Rx
frap.rxburn.clip <- dplyr::bind_rows(frap.clip, rxburn.clip)
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = as.factor(type)), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
# scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = type), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
# scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area)), type = type),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = type), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
# scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area)), type = type),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = type), linewidth = 1, alpha = 0.8, position = 'stack') +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area)), type = type),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = type), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
mypalette <- brewer_pal('seq', "YlOrRd")(5)[2:5]
#Create a time series of Fire Severity burned area
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev.clip %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>% #
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
View(frap.rxburn.clip)
p1b <- ggplot() +
#Line of total FRAP burned area in the South Sierra
# geom_line(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#           group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area / 10000, color = "Wild"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = frap.rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010) %>% #
group_by(YEAR_, .groups = 'keep', type) %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = type), linewidth = 1, alpha = 0.8) +
# Line of total RxBurn burned area in the South Sierra
# geom_line(data = rxburn %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE) %>%
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area /10000, color = "Prescribed"), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
# geom_bar(stat = 'identity', data = rxburn.clip %>% filter(YEAR_ >= 1987 & intersects == TRUE & YEAR_ <= 2010 ) %>% #& intersects == TRUE
#             group_by(YEAR_, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
#           mapping = aes(x = as.Date(as.character(YEAR_), format = "%Y"), y = Area * 1/10000, fill = "Prescribed"), linewidth = 1, alpha = 0.8, position = 'stack') +
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.8), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12), legend.text = element_text(size = 10),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.text.x = element_blank(), axis.title.x = element_blank()) +
scale_fill_manual(name="Fire Type",values=cols, aesthetics = 'fill') +
# scale_linetype_manual(name="Fire Type (FRAP)", values = lines) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab(NULL)
p1b
mypalette <- brewer_pal('seq', "YlOrRd")(5)[2:5]
#Create a time series of Fire Severity burned area
p1c <- ggplot() +
#Line of total USFS burned area in the South Sierra
# geom_line(data = fire.sev %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>%
#             group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(Shape_Area)),
#           mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
#                         color = as.factor(BURNSEV)), linewidth = 1, linetype = 'dashed', alpha = 0.8) +
geom_bar(stat = 'identity', data = fire.sev.clip %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE & BURNSEV != 255) %>% #
group_by(FIRE_YEAR, BURNSEV, .groups = 'keep') %>% reframe(Area = sum(as.numeric(area))),
mapping = aes(x = as.Date(as.character(FIRE_YEAR), format = "%Y"), y = Area * 1/10000,
fill = as.factor(BURNSEV)), linewidth = 1, alpha = 0.8) +
#Do the black and white theme
theme_bw() +
#Figure
theme(legend.position = c(0.25, 0.7), legend.background = element_rect(colour = NA, fill = NA), legend.direction = "vertical",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12)) +
scale_fill_manual(name="Fire Severity", labels = c('Lowest', 'Low', 'Moderate', 'High'), values = mypalette, aesthetics = 'fill') +
# scale_linetype_discrete(name="Fire Severity", labels = c('Unchanged', 'Low', 'Moderate', 'High')) +
scale_y_continuous(labels = comma) +
ylab('Burned Area (ha)') + xlab('Year')
p1c
#Combining the panels into one plot with patchwork
p2 <- (p1a)
p3 <- (p1b / p1c)
(p2 | p3) + plot_layout(ncol = 2, widths = c(1.1, 0.9)) + plot_annotation(tag_levels = 'a')
#Save the plots
ggsave(filename = 'Fig1_fire_maps.png', height=18, width= 18, units = 'cm', dpi=900)
p2a <- ggplot() +
geom_sf(data = frap.clip %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE), mapping = aes(fill = as.numeric(YEAR_))) +
geom_sf(data = usfs.sierra.union, color='black', size = 0.4,  fill = NA) +
coord_sf() + xlab('Longitude') + ylab('Latitude') +
scale_fill_viridis_c(name = 'Fire Year', option = 'inferno', na.value = NA) + theme_bw() + facet_wrap(~title) +
theme(
legend.justification = c(1, 0),
legend.position = c(0.3, 0.2),
legend.text = element_text(size = 8),
legend.title = element_text(size = 10),
strip.text.x = element_text(size = 12),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
legend.direction = "vertical")
p2a
#Prescribed Fire Perimeters
p2b <- ggplot() +
geom_sf(data = rxburn.clip %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE), mapping = aes(fill = as.numeric(YEAR_))) +
geom_sf(data = usfs.sierra.union, color='black', size = 0.4,  fill = NA) +
coord_sf() + xlab('Longitude') + ylab(NULL) +
scale_fill_viridis_c(name = 'Fire Year', option = 'inferno', na.value = NA) + theme_bw() + facet_wrap(~title) +
theme(
legend.justification = c(1, 0),
legend.position = 'none',
legend.text = element_text(size = 8),
legend.title = element_text(size = 10),
strip.text.x = element_text(size = 12),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
legend.direction = "vertical")
p2b
#Fire Severity Perimeters
p2c <- ggplot() +
# geom_sf(data = frap %>% filter(YEAR_ >= 1987 & YEAR_ <= 2010 & intersects == TRUE), mapping = aes(fill = YEAR_), color = 'black', linewidth = 1) +
geom_sf(data = fire.sev.perimeter.clip %>% filter(FIRE_YEAR >= 1987 & FIRE_YEAR <= 2010 & intersects == TRUE), mapping = aes(fill = as.numeric(FIRE_YEAR))) +
geom_sf(data = usfs.sierra.union, color='black', size = 0.4,  fill = NA) +
coord_sf() + xlab('Longitude') + ylab(NULL) +
scale_fill_viridis_c(name = 'Fire Year', option = 'inferno', na.value = NA) + theme_bw() + facet_wrap(~title) +
theme(
legend.justification = c(1, 0),
legend.position = 'none',
legend.text = element_text(size = 8),
legend.title = element_text(size = 10),
strip.text.x = element_text(size = 12),
axis.text.x = element_text(size = 10), axis.title.x = element_text(size = 12),
axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
legend.direction = "vertical")
p2c
p4 <- (p2a | p2b | p2c) + plot_annotation(tag_levels = 'a')
#Save the plots
ggsave(filename = 'FigS1_fire_maps.png', height=20, width= 30, units = 'cm', dpi=900)
