#Select the columns I want for the data
sev.results.data <- sev.pixel.summary %>% dplyr::select(sev.bin, stand.age, tree.ci.95.lower, tree.ci.95.upper, shrub.ci.95.lower, shrub.ci.95.upper, et.ci.95.lower, et.ci.95.upper)
#Create Figure 3
#Create a unique palette
mypalette <- brewer_pal('seq', "YlOrRd")(5)[2:5]
p2a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Tree_Cover.mean, color = sev.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control']),
Tree_Cover.sd = sd(dTree_Cover[treatment == 'Disturb'])^2 + sd(dTree_Cover[treatment == 'Control'])^2,
Tree_Cover.n = n()),
mapping = aes(ymin=Tree_Cover.mean - 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
ymax=Tree_Cover.mean + 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = c(0.06, 0.4), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 2), legend.text = element_text(size = 10)) +
scale_color_manual(values = mypalette, name = 'Fire Severity') +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression('Tree Cover Change (%)')) + xlab('Years Since Fire')
p2a
#Pr-ET change with wildfire (FRAP)
p2b <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Shrub_Cover.mean = mean(dShrub_Cover[treatment == 'Disturb']) - mean(dShrub_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Shrub_Cover.mean, color = sev.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Shrub_Cover.mean = mean(dShrub_Cover[treatment == 'Disturb']) - mean(dShrub_Cover[treatment == 'Control']),
Shrub_Cover.sd = sd(dShrub_Cover[treatment == 'Disturb'])^2 + sd(dShrub_Cover[treatment == 'Control'])^2,
Shrub_Cover.n = n()),
mapping = aes(ymin=Shrub_Cover.mean - 1.96*(sqrt(Shrub_Cover.sd / Shrub_Cover.n)),
ymax=Shrub_Cover.mean + 1.96*(sqrt(Shrub_Cover.sd / Shrub_Cover.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = 'none', legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_manual(values = mypalette, name = 'Fire Severity') +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression('Shrub Cover Change (%)')) + xlab('Years Since Fire')
p2b
#AET change with wildfire (FRAP)
p2c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # & #& elevation >= elev.lower & clm_temp_mean_mean >= temp.lower & clm_precip_sum_mean <= ppt.upper & stratlayer %in% strat.list
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control'])),
mapping = aes(x = stand.age, y = AET.mean, color = sev.bin), size = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control']),
AET.sd = sd(dAET[treatment == 'Disturb'])^2 + sd(dAET[treatment == 'Control'])^2,
AET.n = n()),
mapping = aes(ymin=AET.mean - 1.96*(sqrt(AET.sd / AET.n)),
ymax=AET.mean + 1.96*(sqrt(AET.sd / AET.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12), legend.position = 'none', legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 10),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
#Add the Color and fill scales
scale_color_manual(values = mypalette, name = 'Fire Severity') +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('ET Change', '(mm yr'^-1*')'))) + xlab('Years Since Fire')
p2c
f2 <- ggarrange(p2a,p2b,p2c, nrow = 3, ncol = 1, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a', 'b', 'c'))
f2
p2a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Tree_Cover.mean, color = sev.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control']),
Tree_Cover.sd = sd(dTree_Cover[treatment == 'Disturb'])^2 + sd(dTree_Cover[treatment == 'Control'])^2,
Tree_Cover.n = n()),
mapping = aes(ymin=Tree_Cover.mean - 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
ymax=Tree_Cover.mean + 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = c(0.06, 0.4), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
scale_color_manual(values = mypalette, name = 'Fire Severity') +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression('Tree Cover Change (%)')) + xlab('Years Since Fire')
p2a
f2 <- ggarrange(p2a,p2b,p2c, nrow = 3, ncol = 1, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a', 'b', 'c'))
f2
#Save the data
ggsave(filename = 'Fig3_sev_fire_stand_age_tree_shrub_ET.png', height=15, width= 20, units = 'cm', dpi=900)
p2a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Tree_Cover.mean, color = sev.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control']),
Tree_Cover.sd = sd(dTree_Cover[treatment == 'Disturb'])^2 + sd(dTree_Cover[treatment == 'Control'])^2,
Tree_Cover.n = n()),
mapping = aes(ymin=Tree_Cover.mean - 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
ymax=Tree_Cover.mean + 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = c(0.06, 0.4), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
scale_color_manual(values = mypalette, name = 'Fire Severity') +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('Tree Cover', 'Change (%)'))) + xlab('Years Since Fire')
p2a
#Pr-ET change with wildfire (FRAP)
p2b <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Shrub_Cover.mean = mean(dShrub_Cover[treatment == 'Disturb']) - mean(dShrub_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Shrub_Cover.mean, color = sev.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Shrub_Cover.mean = mean(dShrub_Cover[treatment == 'Disturb']) - mean(dShrub_Cover[treatment == 'Control']),
Shrub_Cover.sd = sd(dShrub_Cover[treatment == 'Disturb'])^2 + sd(dShrub_Cover[treatment == 'Control'])^2,
Shrub_Cover.n = n()),
mapping = aes(ymin=Shrub_Cover.mean - 1.96*(sqrt(Shrub_Cover.sd / Shrub_Cover.n)),
ymax=Shrub_Cover.mean + 1.96*(sqrt(Shrub_Cover.sd / Shrub_Cover.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = 'none', legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_manual(values = mypalette, name = 'Fire Severity') +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('Shrub Cover', 'Change (%)'))) + xlab('Years Since Fire')
p2b
f2 <- ggarrange(p2a, p2b, p2c, nrow = 3, ncol = 1, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a', 'b', 'c'))
f2
#Save the data
#Save the data
ggsave(filename = 'Fig3_sev_fire_stand_age_tree_shrub_ET.png', height=15, width= 20, units = 'cm', dpi=900)
p2a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Tree_Cover.mean, color = sev.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control']),
Tree_Cover.sd = sd(dTree_Cover[treatment == 'Disturb'])^2 + sd(dTree_Cover[treatment == 'Control'])^2,
Tree_Cover.n = n()),
mapping = aes(ymin=Tree_Cover.mean - 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
ymax=Tree_Cover.mean + 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = c(0.06, 0.4), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
scale_color_manual(values = mypalette, name = 'Fire Severity') +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(labels = c('Lowest', 'Low', 'Mid', 'High')), linetype = 'none', fill = 'none') +
ylab(expression(atop('Tree Cover', 'Change (%)'))) + xlab('Years Since Fire')
p2a
p2a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Tree_Cover.mean, color = sev.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control']),
Tree_Cover.sd = sd(dTree_Cover[treatment == 'Disturb'])^2 + sd(dTree_Cover[treatment == 'Control'])^2,
Tree_Cover.n = n()),
mapping = aes(ymin=Tree_Cover.mean - 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
ymax=Tree_Cover.mean + 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = c(0.06, 0.4), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
scale_color_manual(values = mypalette, name = 'Fire Severity', labels = c('Lowest', 'Low', 'Mid', 'High')) +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('Tree Cover', 'Change (%)'))) + xlab('Years Since Fire')
p2a
f2 <- ggarrange(p2a, p2b, p2c, nrow = 3, ncol = 1, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a', 'b', 'c'))
f2
#Save the data
ggsave(filename = 'Fig3_sev_fire_stand_age_tree_shrub_ET.png', height=15, width= 20, units = 'cm', dpi=900)
p2c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # & #& elevation >= elev.lower & clm_temp_mean_mean >= temp.lower & clm_precip_sum_mean <= ppt.upper & stratlayer %in% strat.list
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control'])),
mapping = aes(x = stand.age, y = AET.mean, color = sev.bin), size = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control']),
AET.sd = sd(dAET[treatment == 'Disturb'])^2 + sd(dAET[treatment == 'Control'])^2,
AET.n = n()),
mapping = aes(ymin=AET.mean - 1.96*(sqrt(AET.sd / AET.n)),
ymax=AET.mean + 1.96*(sqrt(AET.sd / AET.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12), legend.position = c(0.8, 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 10),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
#Add the Color and fill scales
scale_color_manual(values = mypalette, name = 'Fire Severity', labels = c('Lowest', 'Low', 'Mid', 'High')) +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('ET Change', '(mm yr'^-1*')'))) + xlab('Years Since Fire')
p2c
p2c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # & #& elevation >= elev.lower & clm_temp_mean_mean >= temp.lower & clm_precip_sum_mean <= ppt.upper & stratlayer %in% strat.list
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control'])),
mapping = aes(x = stand.age, y = AET.mean, color = sev.bin), size = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control']),
AET.sd = sd(dAET[treatment == 'Disturb'])^2 + sd(dAET[treatment == 'Control'])^2,
AET.n = n()),
mapping = aes(ymin=AET.mean - 1.96*(sqrt(AET.sd / AET.n)),
ymax=AET.mean + 1.96*(sqrt(AET.sd / AET.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12), legend.position = c(0.8, 0.2), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 10),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
#Add the Color and fill scales
scale_color_manual(values = mypalette, name = 'Fire Severity', labels = c('Lowest', 'Low', 'Mid', 'High')) +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('ET Change', '(mm yr'^-1*')'))) + xlab('Years Since Fire')
p2c
p2a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Tree_Cover.mean, color = sev.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control']),
Tree_Cover.sd = sd(dTree_Cover[treatment == 'Disturb'])^2 + sd(dTree_Cover[treatment == 'Control'])^2,
Tree_Cover.n = n()),
mapping = aes(ymin=Tree_Cover.mean - 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
ymax=Tree_Cover.mean + 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = 'none', legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
scale_color_manual(values = mypalette, name = 'Fire Severity', labels = c('Lowest', 'Low', 'Mid', 'High')) +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('Tree Cover', 'Change (%)'))) + xlab('Years Since Fire')
p2a
f2 <- ggarrange(p2a, p2b, p2c, nrow = 3, ncol = 1, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a', 'b', 'c'))
f2
#Save the data
ggsave(filename = 'Fig3_sev_fire_stand_age_tree_shrub_ET.png', height=15, width= 20, units = 'cm', dpi=900)
p2c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # & #& elevation >= elev.lower & clm_temp_mean_mean >= temp.lower & clm_precip_sum_mean <= ppt.upper & stratlayer %in% strat.list
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control'])),
mapping = aes(x = stand.age, y = AET.mean, color = sev.bin), size = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control']),
AET.sd = sd(dAET[treatment == 'Disturb'])^2 + sd(dAET[treatment == 'Control'])^2,
AET.n = n()),
mapping = aes(ymin=AET.mean - 1.96*(sqrt(AET.sd / AET.n)),
ymax=AET.mean + 1.96*(sqrt(AET.sd / AET.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12), legend.position = c(0.9, 0.3), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 10),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
#Add the Color and fill scales
scale_color_manual(values = mypalette, name = 'Fire Severity', labels = c('Lowest', 'Low', 'Mid', 'High')) +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('ET Change', '(mm yr'^-1*')'))) + xlab('Years Since Fire')
p2c
f2 <- ggarrange(p2a, p2b, p2c, nrow = 3, ncol = 1, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a', 'b', 'c'))
f2
#Save the data
ggsave(filename = 'Fig3_sev_fire_stand_age_tree_shrub_ET.png', height=15, width= 20, units = 'cm', dpi=900)
p2c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # & #& elevation >= elev.lower & clm_temp_mean_mean >= temp.lower & clm_precip_sum_mean <= ppt.upper & stratlayer %in% strat.list
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control'])),
mapping = aes(x = stand.age, y = AET.mean, color = sev.bin), size = 1) +
#Tree Cover 95% CI
geom_ribbon(data = sev.pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & !is.na(Shrub_Cover) & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, sev.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control']),
AET.sd = sd(dAET[treatment == 'Disturb'])^2 + sd(dAET[treatment == 'Control'])^2,
AET.n = n()),
mapping = aes(ymin=AET.mean - 1.96*(sqrt(AET.sd / AET.n)),
ymax=AET.mean + 1.96*(sqrt(AET.sd / AET.n)),
x = stand.age, fill = sev.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12), legend.position = c(0.8, 0.25), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 10),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
#Add the Color and fill scales
scale_color_manual(values = mypalette, name = 'Fire Severity', labels = c('Lowest', 'Low', 'Mid', 'High')) +
scale_fill_manual(values = mypalette, name = 'Fire Severity') +
guides(color = guide_legend(nrow = 2, ncol = 2), linetype = 'none', fill = 'none') +
ylab(expression(atop('ET Change', '(mm yr'^-1*')'))) + xlab('Years Since Fire')
p2c
f2 <- ggarrange(p2a, p2b, p2c, nrow = 3, ncol = 1, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a', 'b', 'c'))
f2
#Save the data
ggsave(filename = 'Fig3_sev_fire_stand_age_tree_shrub_ET.png', height=15, width= 20, units = 'cm', dpi=900)
p2a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, fire.type.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Tree_Cover.mean, color = fire.type.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, fire.type.bin) %>%
summarize(Tree_Cover.mean = mean(dTree_Cover[treatment == 'Disturb']) - mean(dTree_Cover[treatment == 'Control']),
Tree_Cover.sd = sd(dTree_Cover[treatment == 'Disturb'])^2 + sd(dTree_Cover[treatment == 'Control'])^2,
Tree_Cover.n = n()),
mapping = aes(ymin=Tree_Cover.mean - 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
ymax=Tree_Cover.mean + 1.96*(sqrt(Tree_Cover.sd / Tree_Cover.n)),
x = stand.age, fill = fire.type.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = c(0.065, 0.4), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 12), legend.text = element_text(size = 10)) +
scale_color_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
# scale_fill_manual(values = fills) +
# guides(fill = "none") +
ylab(expression(atop('Tree Cover', 'Change (%)'))) + xlab('Years Since Fire')
p2a
#Pr-ET change with wildfire (FRAP)
p2b <- ggplot() +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, fire.type.bin) %>%
summarize(Shrub_Cover.mean = mean(dShrub_Cover[treatment == 'Disturb']) - mean(dShrub_Cover[treatment == 'Control'])),
mapping = aes(x = stand.age, y = Shrub_Cover.mean, color = fire.type.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>%
group_by(stand.age, fire.type.bin) %>%
summarize(Shrub_Cover.mean = mean(dShrub_Cover[treatment == 'Disturb']) - mean(dShrub_Cover[treatment == 'Control']),
Shrub_Cover.sd = sd(dShrub_Cover[treatment == 'Disturb'])^2 + sd(dShrub_Cover[treatment == 'Control'])^2,
Shrub_Cover.n = n()),
mapping = aes(ymin=Shrub_Cover.mean - 1.96*(sqrt(Shrub_Cover.sd / Shrub_Cover.n)),
ymax=Shrub_Cover.mean + 1.96*(sqrt(Shrub_Cover.sd / Shrub_Cover.n)),
x = stand.age, fill = fire.type.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_blank(), legend.position = 'none', legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
scale_color_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
ylab(expression(atop('Shrub Cover', 'Change (%)'))) + xlab('Years Since Fire')
p2b
#AET change with wildfire (FRAP)
p2c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
#Create a Tree Cover line
geom_line(data = pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # & #& elevation >= elev.lower & clm_temp_mean_mean >= temp.lower & clm_precip_sum_mean <= ppt.upper & stratlayer %in% strat.list
group_by(stand.age, fire.type.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control'])),
mapping = aes(x = stand.age, y = AET.mean, color = fire.type.bin), linewidth = 1) +
#Tree Cover 95% CI
geom_ribbon(data = pixel.sample %>%
filter(stand.age >= -2 & stand.age <= 20 & vi.year <= 2012 & fire.year > 1986 & fire.year <= 2010 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # & #& elevation >= elev.lower & clm_temp_mean_mean >= temp.lower & clm_precip_sum_mean <= ppt.upper & stratlayer %in% strat.list
group_by(stand.age, fire.type.bin) %>%
summarize(AET.mean = mean(dAET[treatment == 'Disturb']) - mean(dAET[treatment == 'Control']),
AET.sd = sd(dAET[treatment == 'Disturb'])^2 + sd(dAET[treatment == 'Control'])^2,
AET.n = n()),
mapping = aes(ymin=AET.mean - 1.96*(sqrt(AET.sd / AET.n)),
ymax=AET.mean + 1.96*(sqrt(AET.sd / AET.n)),
x = stand.age, fill = fire.type.bin), alpha = 0.3) +
theme_bw() +
theme(axis.text.y = element_text(size = 10), axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12), legend.position = 'none', legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 10),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
#scale_colour_manual(name="Vegetation Type",values=cols, aesthetics = 'color') +
scale_color_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
guides(color = guide_legend(), linetype = 'none', fill = 'none') +
ylab(expression(atop('ET Change', '(mm yr'^-1*')'))) + xlab('Years Since Fire')
p2c
f1 <- ggarrange(p2a,p2b,p2c, nrow = 3, ncol = 1, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a', 'b', 'c'))
f1
#Save the data
ggsave(filename = 'Fig2_frap_stand_age_tree_shrub_ET.png', height=15, width= 20, units = 'cm', dpi=900)
