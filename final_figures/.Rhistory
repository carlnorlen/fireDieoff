# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p5a
p5c <- ggbarplot(pixel.filter,
y = "Tree_Cover", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab('Pre-Drought \nTree Cover (%)')
p5d <- ggbarplot(pixel.filter,
y = "ET", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab(expression('Pre-Drought \nET (mm yr'^-1*')')) + xlab('Treatment') +
scale_x_discrete(labels = c("Unburned", "Burned")) #+
p5d
f7 <- ggarrange(p5a, p5b, p5c, p5d, ncol = 1, nrow = 4, common.legend = FALSE, heights = c(1, 0.9, 0.9, 1), align = "hv", labels = c('a', 'b', 'c', 'c'))
f7
#Save the figure
ggsave(filename = 'Fig4_frap_rx_comparison_barchart.png', height=24, width= 18, units = 'cm', dpi=900)
p5a <- ggbarplot(pixel.filter,
y = "ADS", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.text.x = element_text(size = 10, face = 'bold')) +
ylab(expression('Die-off (trees ha'^-1*')'))
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p5a
p5b <- ggbarplot(pixel.filter,
y = "dTree", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab(expression('Die-off ('*Delta*'Tree %)'))
p5b
p5c <- ggbarplot(pixel.filter,
y = "Tree_Cover", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab('Pre-Drought \nTree Cover (%)')
p5d <- ggbarplot(pixel.filter,
y = "ET", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab(expression('Pre-Drought \nET (mm yr'^-1*')')) + xlab('Treatment') +
scale_x_discrete(labels = c("Unburned", "Burned")) #+
p5d
f7 <- ggarrange(p5a, p5b, p5c, p5d, ncol = 1, nrow = 4, common.legend = FALSE, heights = c(1, 0.9, 0.9, 1), align = "hv", labels = c('a', 'b', 'c', 'c'))
f7
p5a <- ggbarplot(pixel.filter,
y = "ADS", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.text.x = element_text(size = 10, face = 'bold')) +
ylab(expression(atop('Die-off Severity','(trees ha'^-1*')')))
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p5a
p5b <- ggbarplot(pixel.filter,
y = "dTree", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
yla
p5b <- ggbarplot(pixel.filter,
y = "dTree", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab(expression(atop('Die-off Severity', '('*Delta*'Tree %)')))
p5b
p5c <- ggbarplot(pixel.filter,
y = "Tree_Cover", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab('Tree Cover (%)')
p5d <- ggbarplot(pixel.filter,
y = "ET", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab(expression('ET (mm yr'^-1*')')) + xlab('Treatment') +
scale_x_discrete(labels = c("Unburned", "Burned")) #+
p5d
f7 <- ggarrange(p5a, p5b, p5c, p5d, ncol = 1, nrow = 4, common.legend = FALSE, heights = c(1, 0.9, 0.9, 1), align = "hv", labels = c('a', 'b', 'c', 'c'))
f7
#Save the figure
ggsave(filename = 'Fig4_frap_rx_comparison_barchart.png', height=18, width= 12, units = 'cm', dpi=900)
f7 <- ggarrange(p5a, p5b, p5c, p5d, ncol = 1, nrow = 4, common.legend = FALSE, heights = c(1, 0.9, 0.9, 1), align = "hv", labels = c('a', 'b', 'c', 'd'))
f7
#Save the figure
ggsave(filename = 'Fig4_frap_rx_comparison_barchart.png', height=12, width= 8, units = 'cm', dpi=900)
#Save the figure
ggsave(filename = 'Fig4_frap_rx_comparison_barchart.png', height=18, width= 12, units = 'cm', dpi=900)
f7 <- p7a / p7b / p7c / p7d
p7a <- ggbarplot(pixel.filter,
y = "ADS", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.text.x = element_text(size = 10, face = 'bold')) +
ylab(expression(atop('Die-off Severity','(trees ha'^-1*')')))
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p7a
p7b <- ggbarplot(pixel.filter,
y = "dTree", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab(expression(atop('Die-off Severity', '('*Delta*'Tree %)')))
p7b
p7c <- ggbarplot(pixel.filter,
y = "Tree_Cover", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab('Tree Cover (%)')
p7d <- ggbarplot(pixel.filter,
y = "ET", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
ylab(expression('ET (mm yr'^-1*')')) + xlab('Treatment') +
scale_x_discrete(labels = c("Unburned", "Burned")) #+
p7d
# f7 <- ggarrange(p7a, p7b, p7c, p7d, ncol = 1, nrow = 4, common.legend = FALSE, heights = c(1, 0.9, 0.9, 1), align = "hv", labels = c('a', 'b', 'c', 'd'))
# f7
f7 <- p7a / p7b / p7c / p7d
f7
f7 <- p7a / p7b / p7c / p7d + plot_annotation(tag_levels = 'a')
f7
f7 <- (p7a / p7b / p7c / p7d) + plot_annotation(tag_levels = 'a')
f7
#Save the figure
ggsave(filename = 'Fig4_frap_rx_comparison_barchart.png', height=18, width= 12, units = 'cm', dpi=900)
p7a <- ggbarplot(pixel.filter,
y = "ADS", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.text.x = element_text(size = 10, face = 'bold')) +
labs(tag = 'a') +
ylab(expression(atop('Die-off Severity','(trees ha'^-1*')')))
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p7a
p7b <- ggbarplot(pixel.filter,
y = "dTree", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
labs(tag = 'b') +
ylab(expression(atop('Die-off Severity', '('*Delta*'Tree %)')))
p7b
p7c <- ggbarplot(pixel.filter,
y = "Tree_Cover", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
labs(tag = 'c') +
ylab('Tree Cover (%)')
p7d <- ggbarplot(pixel.filter,
y = "ET", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
labs(tag = 'd') +
ylab(expression('ET (mm yr'^-1*')')) + xlab('Treatment') +
scale_x_discrete(labels = c("Unburned", "Burned")) #+
p7d
# f7 <- ggarrange(p7a, p7b, p7c, p7d, ncol = 1, nrow = 4, common.legend = FALSE, heights = c(1, 0.9, 0.9, 1), align = "hv", labels = c('a', 'b', 'c', 'd'))
# f7
f7 <- (p7a / p7b / p7c / p7d) #+ plot_annotation(tag_levels = 'a')
f7
p7a <- ggbarplot(pixel.filter,
y = "ADS", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), #plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.text.x = element_text(size = 10, face = 'bold')) +
#labs(tag = 'a') +
ylab(expression(atop('Die-off Severity','(trees ha'^-1*')')))
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p7a
p7b <- ggbarplot(pixel.filter,
y = "dTree", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), #plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
#labs(tag = 'b') +
ylab(expression(atop('Die-off Severity', '('*Delta*'Tree %)')))
p7b
p7c <- ggbarplot(pixel.filter,
y = "Tree_Cover", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), #plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
#labs(tag = 'c') +
ylab('Tree Cover (%)')
p7d <- ggbarplot(pixel.filter,
y = "ET", position = position_dodge(), facet.by = "fire.type.bin", fill = "fire.type.bin", x = 'treatment',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, width = 0.5,
xlab = NULL, #order = c("1999-2002", "2012-2015")
) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") + #labs(tag = 'b)') +
scale_fill_brewer(type = 'qual', palette = 'Set2', name = 'Fire Type', direction = 1) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 6, angle = 45), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,5), "pt"),
panel.spacing = unit(20, "pt"), #plot.tag.position = c(0.53, 0.96), #c(0.52, 0.96)
plot.tag = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.x = element_blank()) +
#labs(tag = 'd') +
ylab(expression('ET (mm yr'^-1*')')) + xlab('Treatment') +
scale_x_discrete(labels = c("Unburned", "Burned")) #+
p7d
# f7 <- ggarrange(p7a, p7b, p7c, p7d, ncol = 1, nrow = 4, common.legend = FALSE, heights = c(1, 0.9, 0.9, 1), align = "hv", labels = c('a', 'b', 'c', 'd'))
# f7
f7 <- (p7a / p7b / p7c / p7d) + plot_annotation(tag_levels = 'a')
f7
#Save the figure
ggsave(filename = 'Fig4_frap_rx_comparison_barchart.png', height=18, width= 12, units = 'cm', dpi=900)
