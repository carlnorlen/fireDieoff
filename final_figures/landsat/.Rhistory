geom_point(mapping = aes(color = sev.bin), size = 1) +
geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
xlab('Years Since Fire') + ylab('Die-off (trees/ha)')
p4a
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]) %>%
group_by(system.index, sev.bin) %>%
reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = stand.age, y = tpa_max.mean)) +
# facet_grid(.~ fire.type.bin) +
theme_bw() +
geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]) %>%
group_by(system.index, sev.bin) %>%
reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree.mean, y = tpa_max.mean)) +
# facet_grid(.~ fire.type.bin) +
theme_bw() +
geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree.mean, y = tpa_max.mean)) +
# facet_grid(.~ fire.type.bin) +
theme_bw() +
geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree, y = tpa_max)) +
# facet_grid(.~ fire.type.bin) +
theme_bw() +
geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
x
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015])
sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin)
sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015])
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & Tree_Cover > 0 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & Tree_Cover > 0 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015])
sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & !is.na(Tree_Cover) & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015])
summary(sev.pixels)
summary(sev.pixel.sample)
sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & vi.year > 2012 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]))
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
# geom_smooth(mapping = aes(color = fire.type.bin), method = 'lm') +
# stat_cor(mapping = aes(color = fire.type.bin)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
geom_smooth(mapping = aes(color = sev.bin), method = 'lm') +
stat_cor(mapping = aes(color = sev.bin)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
geom_smooth(mapping = aes(color = treatment), method = 'lm') +
stat_cor(mapping = aes(color = treatment)) +
xlab('dTree') + ylab('dDie-off (trees/ha)')
p4a
p4a <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Tree, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
geom_smooth(mapping = aes(color = treatment), method = 'lm') +
stat_cor(mapping = aes(color = treatment)) +
xlab('Tree Cover (%)') + ylab(expression('Die-off (trees ha'^-1*')'))
p4a
p4b <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = Water_Stress[vi.year == 2015],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = ET, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
geom_smooth(mapping = aes(color = treatment), method = 'lm') +
stat_cor(mapping = aes(color = treatment)) +
xlab(expression('ET (mm yr'^-1*')')) + ylab(expression('Die-off (trees ha'^-1*')'))
p4b
p4c <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = PrET[vi.year %in% c(2012,2013,2014,2015)],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Water_Stress, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
geom_smooth(mapping = aes(color = treatment), method = 'lm') +
stat_cor(mapping = aes(color = treatment)) +
xlab(expression('Pr-ET (mm 4yr'^-1*')')) + ylab(expression('Die-off (trees ha'^-1*')'))
p4c
p4d <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = PrET[vi.year %in% c(2012,2013,2014,2015)],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = Water_Stress, y = stand.age, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
geom_smooth(mapping = aes(color = treatment), method = 'lm') +
stat_cor(mapping = aes(color = treatment)) +
xlab(expression('Pr-ET (mm 4yr'^-1*')')) + ylab(expression('Die-off (trees ha'^-1*')'))
p4d
p4d <- ggplot(data = sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = PrET[vi.year %in% c(2012,2013,2014,2015)],
stand.age = stand.age[vi.year == 2015]), # %>%
# group_by(system.index, sev.bin) %>%
# reframe(tpa_max.mean = mean(tpa_max[treatment == 'Disturb']) - mean(tpa_max[treatment == 'Control']),
#         Tree.mean = mean(Tree[treatment == 'Disturb']) - mean(Tree[treatment == 'Control'])),
mapping = aes(x = stand.age, y = tpa_max, color = treatment)) +
facet_grid(.~ sev.bin) +
theme_bw() +
geom_point() +
# geom_point(mapping = aes(color = sev.bin), size = 1) +
# geom_line(mapping = aes(color = sev.bin), linewidth = 1) +
geom_smooth(mapping = aes(color = treatment), method = 'lm') +
stat_cor(mapping = aes(color = treatment)) +
xlab('Years Since Fire') + ylab(expression('Die-off (trees ha'^-1*')'))
p4d
model.data <- sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = PrET[vi.year %in% c(2012,2013,2014,2015)],
stand.age = stand.age[vi.year == 2015])
model.data <- sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = PrET[vi.year %in% c(2012,2013,2014,2015)],
stand.age = stand.age[vi.year == 2015])
sev.lm <- lm(data = model.data, model = tpa_max ~ ET + Tree + Water_Stress + stand.age)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age)
summary(sev.lm)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age + sev.bin)
summary(sev.lm)
summary(model.data)
model.data <- sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = PrET[vi.year %in% c(2012,2013,2014,2015)],
stand.age = stand.age[vi.year == 2015],
fire_sev = fire_sev_2010[vi.year == 2015])
summary(model.data)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age + fire_sev)
summary(sev.lm)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age)
summary(sev.lm)
model.data <- sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = PrET[vi.year %in% c(2012,2013,2014,2015)],
stand.age = stand.age[vi.year == 2015],
fire_sev = fire_sev_2010[vi.year == 2015])
summary(model.data)
dtree.lm <- lm(data = model.data, formula = dTree ~ ET + Tree + Water_Stress + stand.age)
summary(dtree.lm)
install.packages('mgcv',repo='https://cran.r-project.org/')
install.packages("mgcv", repo = "https://cran.r-project.org/")
dieoff_gam <- model.data %>%
gam(tpa_max ~
# s(log(area),bs='cs') +
s(Tree,bs='cs') +
s(ET,bs='cs') +
s(Water_Stress,bs='cs') +
s(stand.age,bs='cs') #+
#s(prefire_fullmean,bs='cs') +
#s(reburned_perc,bs='cs') +
#s(firestartyear,bs='cs'),# +
data = .,method='REML')
dieoff_gam <- model.data %>%
gam(tpa_max ~
# s(log(area),bs='cs') +
s(Tree,bs='cs') +
s(ET,bs='cs') +
s(Water_Stress,bs='cs') +
s(stand.age,bs='cs'), #+
#s(prefire_fullmean,bs='cs') +
#s(reburned_perc,bs='cs') +
#s(firestartyear,bs='cs'),# +
data = .,method='REML')
summary(dieoff_gam)
dieoff_gam_perc_plot <- getViz(dieoff_gam)
install.packages('mgcViz',repo='https://cran.r-project.org/')
library(mgcViz)
dieoff_gam_perc_plot <- getViz(dieoff_gam)
dieoff_gam_perc_plot
dieoff_gam_int = coef(dieoff_gam)[1]
dieoff_gam_int
print(plot(dieoff_gam_perc_plot, allTerms = TRUE), pages = 1)
gam1_trees <- ggplot(plot(sm(dieoff_gam_perc_plot, 1))$data$fit) + geom_line(aes(x=x,y=y),size=0.75) +
geom_ribbon(aes(x=x,ymax=y+se,ymin=y-se),alpha=0.2) +
#coord_cartesian(ylim=c(-75,25)) +
theme(axis.title.y=element_blank()) +
geom_hline(yintercept=0,alpha=0.5,size=0.5) +
labs(x='Tree Cover (%)',y=expression(Mortality~residual~(trees~har^-1)))
gam1_trees
dieoff_gam <- model.data %>%
gam(tpa_max ~
# s(log(area),bs='cs') +
s(Tree,bs='cs') +
s(ET,bs='cs') +
s(Water_Stress,bs='cs'), # +
# s(stand.age,bs='cs'), #+
#s(prefire_fullmean,bs='cs') +
#s(reburned_perc,bs='cs') +
#s(firestartyear,bs='cs'),# +
data = .,method='REML')
summary(dieoff_gam)
dieoff_gam_perc_plot <- getViz(dieoff_gam)
dieoff_gam_perc_plot
#Plot out the non-linear relationships?
print(plot(dieoff_gam_perc_plot, allTerms = TRUE), pages = 1)
glimpse(sev.pixel.sample)
model.data <- sev.pixel.sample %>% filter(fire.year <= 2010 & fire.year >= 1986 & (fire_year_2019 <= 2010 | is.na(fire_year_2019))) %>% # &
dplyr::group_by(system.index, treatment, sev.bin) %>%
reframe(dTree = (mean(Tree_Cover[vi.year %in% c(2017, 2018)]) - mean(Tree_Cover[vi.year %in% c(2011,2012)])),
Tree = mean(Tree_Cover[vi.year %in% c(2011,2012)]),
ET = mean(AET[vi.year %in% c(2011,2012)]),
tpa_max = sum(tpa_max[vi.year %in% c(2015, 2016, 2017, 2018)], na.rm = TRUE),
Water_Stress = PrET[vi.year %in% c(2012,2013,2014,2015)],
stand.age = stand.age[vi.year == 2015],
fire_sev = fire_sev_2010[vi.year == 2015],
ppt_climate = clm_precip_sum[vi.year == 2015],
temp_climate = clm_temp_mean[vi.year == 2015],
elevation = elevation[vi.year == 2015])
summary(model.data)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age +elevation + ppt_climate + temp_climate)
summary(sev.lm)
dieoff_gam <- model.data %>%
gam(tpa_max ~
# s(log(area),bs='cs') +
s(Tree,bs='cs') +
s(ET,bs='cs') +
s(Water_Stress,bs='cs') +
s(stand.age,bs='cs') +
s(ppt_climate,bs='cs') +
s(temp_climate,bs='cs') +
s(elevation,bs='cs'),
data = .,method='REML')
# plot fancy gam residuals
sm?
gam1_trees <- ggplot(plot(sm(dieoff_gam_perc_plot, 1))$data$fit) + geom_line(aes(x=x,y=y),size=0.75) +
geom_ribbon(aes(x=x,ymax=y+se,ymin=y-se),alpha=0.2) +
#coord_cartesian(ylim=c(-75,25)) +
theme(axis.title.y=element_blank()) +
geom_hline(yintercept=0,alpha=0.5,size=0.5) +
labs(x='Tree Cover (%)',y=expression(Mortality~residual~(trees~har^-1)))
dieoff_gam <- model.data %>%
gam(tpa_max ~
s(Tree,bs='cs') +
s(ET,bs='cs') +
s(Water_Stress,bs='cs') +
s(stand.age,bs='cs') +
s(ppt_climate,bs='cs') +
s(temp_climate,bs='cs') +
s(elevation,bs='cs'),
data = .,method='REML')
summary(dieoff_gam)
dieoff_gam_perc_plot <- getViz(dieoff_gam)
dieoff_gam_perc_plot
#Plot out the non-linear relationships?
print(plot(dieoff_gam_perc_plot, allTerms = TRUE), pages = 1)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age + elevation + ppt_climate + temp_climate)
summary(sev.lm)
library(realimpo)
library(relaimpo)
dieoff.relimp <- calc.relimp(sev.lm, rela = TRUE, type = "lmg")
dieoff.relimp
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree) # + Water_Stress + stand.age + elevation + ppt_climate + temp_climate)
summary(sev.lm)
sev.lm <- lm(data = model.data, formula = tpa_max ~ water_Stress) # + stand.age + elevation + ppt_climate + temp_climate)
sev.lm <- lm(data = model.data, formula = tpa_max ~ Water_Stress) # + stand.age + elevation + ppt_climate + temp_climate)
summary(sev.lm)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + stand.age + elevation + ppt_climate + temp_climate)
summary(sev.lm)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age + elevation + ppt_climate + temp_climate + sev.bin)
summary(sev.lm)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age + elevation + ppt_climate + temp_climate + fire_sev)
summary(sev.lm)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age + ppt_climate + temp_climate + fire_sev)
summary(sev.lm)
sev.lm <- lm(data = model.data, formula = tpa_max ~ ET + Tree + Water_Stress + stand.age + elevation + ppt_climate + temp_climate + fire_sev)
summary(sev.lm)
dieoff.relimp <- calc.relimp(sev.lm, rela = TRUE, type = "lmg")
dieoff.relimp
