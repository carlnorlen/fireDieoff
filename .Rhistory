q()
p <- c('ggpubr', 'viridis', 'tidyr', 'dplyr', 'ggplot2', 'stats', 'patchwork', 'data.table')
# install.packages(p,repo='https://cran.r-project.org/')
# install.packages(c('ggmap'),repo='https://cran.r-project.org/')
lapply(p,require,character.only=TRUE)
#Set the working directory
setwd('C:/Users/can02/mystuff/fireDieoff')
#Data directory
dir_in <- "D:\\Large_Files\\Fire_Dieoff"
#Add the data
data <- read.csv(file.path(dir_in, "Flux_tower_veg_indices_30m_11212021_v2.csv"), header = TRUE, na.strings = "NaN")
unique(data$Site)
#Rename the flux tower sites
data$site.name <- recode(.x=data$Site, 'US-SCg' ='Grassland US-SCg', 'US-SCf' = 'Oak Pine US-SCf', 'US-SCd' = 'Desert US-SCd', 'US-CZ3' = 'Mixed Conifer US-CZ3', 'US-SCw' = 'Pinyon US-SCw', 'US-CZ1' = 'Oak Pine US-CZ1', 'US-SCs' = 'Coastal Sage US-SCs',
'US-CZ4' = 'Subalpine US-CZ4', 'US-CZ2' = 'Ponderosa Pine US-CZ2', 'US-SCc' = 'Chaparral US-SCc')
#Format dates for the data
data$date <- as.Date(data$date)
data$year <- format(data$date, '%Y')
data$month <- format(data$date, '%m')
data$yday <- yday(data$date)
#DOY figures
#LMA
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean, color = year)) +
geom_point(size = 0.1) + facet_wrap(~ site.name) + ylab('LMA') +
theme_bw()
p1
ggsave(filename = 'Fig1_Landsat_LMA.png', height=12, width=16, units = 'cm', dpi=900)
#NDMI
p2 <- ggplot(data = data, mapping = aes(x=yday, y = NDMI_mean, color = year)) +
geom_point(size = 0.1) + facet_wrap(~ site.name) + ylab('NDMI') +
theme_bw()
p2
ggsave(filename = 'Fig2_Landsat_NDMI.png', height=12, width=16, units = 'cm', dpi=900)
#NIRv
p3 <- ggplot(data = data, mapping = aes(x=yday, y = NIRv_mean, color = year)) +
geom_point(size = 0.1) + facet_wrap(~ site.name) + ylab('NIRv') +
theme_bw()
p3
ggsave(filename = 'Fig3_Landsat_NIRv.png', height=12, width=16, units = 'cm', dpi=900)
#NIRv
p4 <- ggplot(data = data, mapping = aes(x=yday, y = NDVI_mean, color = year)) +
geom_point(size = 0.1) + facet_wrap(~ site.name) + ylab('NDVI') +
theme_bw()
p4
ggsave(filename = 'Fig4_Landsat_NDVI.png', height=12, width=16, units = 'cm', dpi=900)
#Brightness
p5 <- ggplot(data = data, mapping = aes(x=yday, y = brightness_mean, color = year)) +
geom_point(size = 0.1) + facet_wrap(~ site.name) + ylab('Brightness') +
theme_bw()
p5
ggsave(filename = 'Fig5_Landsat_Brightness.png', height=12, width=16, units = 'cm', dpi=900)
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
# geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#                   group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data) +
# geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#                   group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data) +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data) +
geom_line(data = data %>% filter((month == 3 | month == 4 | month == 5) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p7 <- ggplot(data = data %>% filter(month == 5 | month == 6 | month == 7 & !is.na(NDMI_mean))%>%
group_by(site.name, year) %>% mutate(NDMI.mean = mean(NDMI_mean))) +
geom_line(mapping = aes(x = date, y = NDMI.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p7 <- ggplot(data = data %>% filter(month == 5 | month == 6 | month == 7 & !is.na(NDMI_mean))%>%
group_by(site.name, year) %>% mutate(NDMI.mean = mean(NDMI_mean))) +
geom_line(mapping = aes(x = date, y = NDMI.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p <- c('ggpubr', 'viridis', 'tidyr', 'dplyr', 'ggplot2', 'stats', 'patchwork', 'data.table')
# install.packages(p,repo='https://cran.r-project.org/')
# install.packages(c('ggmap'),repo='https://cran.r-project.org/')
lapply(p,require,character.only=TRUE)
#Set the working directory
setwd('C:/Users/can02/mystuff/fireDieoff')
#Data directory
dir_in <- "D:\\Large_Files\\Fire_Dieoff"
#Add the data
data <- read.csv(file.path(dir_in, "Flux_tower_veg_indices_30m_11212021_v2.csv"), header = TRUE, na.strings = "NaN")
unique(data$Site)
#Rename the flux tower sites
data$site.name <- recode(.x=data$Site, 'US-SCg' ='Grassland US-SCg', 'US-SCf' = 'Oak Pine US-SCf', 'US-SCd' = 'Desert US-SCd', 'US-CZ3' = 'Mixed Conifer US-CZ3', 'US-SCw' = 'Pinyon US-SCw', 'US-CZ1' = 'Oak Pine US-CZ1', 'US-SCs' = 'Coastal Sage US-SCs',
'US-CZ4' = 'Subalpine US-CZ4', 'US-CZ2' = 'Ponderosa Pine US-CZ2', 'US-SCc' = 'Chaparral US-SCc')
#Format dates for the data
data$date <- as.Date(data$date)
data$year <- format(data$date, '%Y')
data$month <- format(data$date, '%m')
data$yday <- yday(data$date)
p7 <- ggplot(data = data %>% filter(month == 5 | month == 6 | month == 7 & !is.na(NDMI_mean))%>%
group_by(site.name, year) %>% mutate(NDMI.mean = mean(NDMI_mean))) +
geom_line(mapping = aes(x = date, y = NDMI.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p7 <- ggplot(data = data %>% filter(month == 8 | month == 9 | month == 10 & !is.na(NDMI_mean))%>%
group_by(site.name, year) %>% mutate(NDMI.mean = mean(NDMI_mean))) +
geom_line(mapping = aes(x = date, y = NDMI.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p6 <- ggplot(data = data) +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(Site != "US-SCd")) +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10)) %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(Site != "US-SCd" & (LMA_mean < 1 & LMA_mean > -1))) +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10)) %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(Site != "US-SCd" )) +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1)) %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot(data = data %>% filter(Site != "US-SCd" )) +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1)) %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
#LMA Time Series
p6 <- ggplot(data = data %>% filter(Site != "US-SCd" )) +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 6 | month == 7 | month == 8) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 6 | month == 7 | month == 8) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 8 | month == 9 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 9 | month == 10 | month == 11) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 7 | month == 8 | month == 9) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 6 | month == 7 | month == 8) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 6 | month == 7 | month == 8) & (LMA_mean < 1 & LMA_mean > -1) & !is.na(LMA_mean) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
# geom_line(data = data %>% filter((month == 5 | month == 6 | month == 7) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == 3 | month == 4) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
data %>% filter((month == 6 | month == 7 | month == 8))
data
p6 <- ggplot() +
geom_line(data = data %>% filter((month == 08 | month == 09 | month == 10) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == 05 | month == 06 | month == 07) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == 03 | month == 04) & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
data %>% filter((month == 05 | month == 06 | month == 07))
data$month <- is.numeric(data$month)
data %>% filter((month == 05 | month == 06 | month == 07))
data %>% filter((month == '05' | month == '06' | month == '07'))
data %>% select(month) %>% unique()
data %>% select(month)
data
p <- c('ggpubr', 'viridis', 'tidyr', 'dplyr', 'ggplot2', 'stats', 'patchwork', 'data.table')
# install.packages(p,repo='https://cran.r-project.org/')
# install.packages(c('ggmap'),repo='https://cran.r-project.org/')
lapply(p,require,character.only=TRUE)
#Set the working directory
setwd('C:/Users/can02/mystuff/fireDieoff')
#Data directory
dir_in <- "D:\\Large_Files\\Fire_Dieoff"
#Add the data
data <- read.csv(file.path(dir_in, "Flux_tower_veg_indices_30m_11212021_v2.csv"), header = TRUE, na.strings = "NaN")
unique(data$Site)
#Rename the flux tower sites
data$site.name <- recode(.x=data$Site, 'US-SCg' ='Grassland US-SCg', 'US-SCf' = 'Oak Pine US-SCf', 'US-SCd' = 'Desert US-SCd', 'US-CZ3' = 'Mixed Conifer US-CZ3', 'US-SCw' = 'Pinyon US-SCw', 'US-CZ1' = 'Oak Pine US-CZ1', 'US-SCs' = 'Coastal Sage US-SCs',
'US-CZ4' = 'Subalpine US-CZ4', 'US-CZ2' = 'Ponderosa Pine US-CZ2', 'US-SCc' = 'Chaparral US-SCc')
#Format dates for the data
data$date <- as.Date(data$date)
data$year <- format(data$date, '%Y')
data$month <- format(data$date, '%m')
data$yday <- yday(data$date)
# data$month <- is.numeric(data$month)
data %>% filter((month == 05 | month == 06 | month == 07))
data %>% filter((month == '05' | month == '06' | month == '07'))
p6 <- ggplot() +
geom_line(data = data %>% filter((month == '08' | month == '09' | month == '10') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == '05' | month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == '03' | month == '04') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == '08' | month == '09' | month == '10') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == '04' | month == '05') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == '08' | month == '09' | month == '10') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == '05' | month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == '04' | month == '05') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == '08' | month == '09' | month == '10') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == '05' | month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == '04' | month == '05') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == '08' | month == '09' | month == '10') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == '04' | month == '05') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == '08' | month == '09' | month == '10') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == '04' | month == '05') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((month == '08' | month == '09' | month == '10') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3") %>%
group_by(site.name, year) %>% mutate(LMA.late = mean(LMA_mean)), mapping = aes(x = date, y = LMA.late), color = 'black', size = 1) +
geom_line(data = data %>% filter((month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3") %>%
group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
geom_line(data = data %>% filter((month == '04' | month == '05') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3") %>%
group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
ggsave(filename = 'Fig6_Landsat_LMA_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p7 <- ggplot(data = data %>% filter(month == '08' | month == '09' | month == '10' & !is.na(NDMI_mean))%>%
group_by(site.name, year) %>% mutate(NDMI.mean = mean(NDMI_mean))) +
geom_line(mapping = aes(x = date, y = NDMI.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p7 <- ggplot(data = data %>% filter((month == '08' | month == '09' | month == '10') & !is.na(NDMI_mean))%>%
group_by(site.name, year) %>% mutate(NDMI.mean = mean(NDMI_mean))) +
geom_line(mapping = aes(x = date, y = NDMI.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
ggsave(filename = 'Fig7_Landsat_NDMI_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p8 <- ggplot(data = data %>% filter((month == '08' | month == '09' | month == '10') & !is.na(NIRv_mean)) %>%
group_by(site.name, year) %>% mutate(NIRv.mean = mean(NIRv_mean))) +
geom_line(mapping = aes(x = date, y = NIRv.mean), color = 'black', size = 1) +
xlab('Year') + ylab('NIRv') + facet_wrap(~ site.name) + theme_bw()
p8
ggsave(filename = 'Fig8_Landsat_NIRv_time_series.png', height=12, width=16, units = 'cm', dpi=900)
