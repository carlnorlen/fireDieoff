summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead))
%>% ungroup(),
x = "disturb.bin", y = "BA.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p2
join.sp %>% summary()
View(join.sp)
p2 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar')),
x = "disturb.bin", y = "BA.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p2
p2 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p2
p3 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p3
join.sp$basal_area.dead.pct <-join.sp$basal_area.dead.pct * 100
p3 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p
p3
p3 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p3
p3 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p3
p2 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak', 'cedar')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p2
p2 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p2
p3 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 10, color = 'black'), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p3
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, align = "v", labels = c("a)", "c)"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
f1 <- ggarrange(p2, p3, ncol = 1, align = "v", labels = c("a)", "c)"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
p2 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p2
p3 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead.pct", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = 'Mortality (%)',
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = 'none', legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_text(size = 8, color = 'black'), axis.title.x = element_text(size = 10, color = 'black'),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.53, 0.96), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p3
#Combine the two figure panels into one
f1 <- ggarrange(p2, p3, ncol = 1, align = "v", labels = c("a", "b"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
p2 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.45, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p2
f1 <- ggarrange(p2, p3, ncol = 1, align = "v", labels = c("a", "b"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig8_fire_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
#Set working directory
#setwd("/C/Users/Carl/mystuff/Goulden_Lab/Forest_Dieback/dieback/figure_set/field_data")
#cd /C/Users/Carl/mystuff/Goulden_Lab/Forest_Dieback/dieback/figure_set/field_data
#cd /C/Users/can02/mystuff/fireDieoff/FIA
#Command for calling the script in the command line: R < stand_age_dieoff.r --vanilla
#INstalling packages: install.packages('RColorBrewer',repo='https://cran.cnr.berkeley.edu/')
# setwd('C:/Users/can02/mystuff/fireDieoff/final_figures/fia')
setwd('C:/Users/can02/mystuff/fireDieoff/final_figures/fia')
f1 <- ggarrange(p2, p3, ncol = 1, align = "v", labels = c("a", "b"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig8_fire_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p2 <- ggbarplot(join.sp %>% ungroup() %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Ground Fire', 'Crown Fire') & tree_type %in% c('pine', 'fir', 'oak')),
x = "disturb.bin", y = "basal_area.dead", fill = 'tree_type.f',
color = "tree_type.f",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = 'Disturbance', order = c("Ground Fire", "Crown Fire")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", label.position = "bottom", title.position="top", title.hjust = 0.5)) +
# scale_color_manual(values = c("black", "black"), aesthetics = "color") + labs(tag = 'd)') +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.2, 0.55), legend.text = element_text(size = 8, angle = 45, vjust = 0.8), legend.title = element_text(size = 10),
legend.direction = "horizontal", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,5), "pt"), panel.spacing = unit(20, "pt"),
plot.tag.position = c(0.2, 0.9), #c(0.54, 0.96)
plot.tag = element_text(face = "bold")) #+
# scale_x_discrete(labels = c("Response During\n1st Period", "Response During\n2nd Period")) +
# geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) #+
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
# facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')),
#            labeller = as_labeller(c('Both Droughts' = "Exposed to Both Droughts", '2nd Drought Only' = "Exposed to 2nd Drought Only")))
p2
f1 <- ggarrange(p2, p3, ncol = 1, align = "v", labels = c("a", "b"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig8_fire_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p <- c('reticulate', 'rgee', 'rgeeExtra','raster', 'sf', 'ggplot2', 'RStoolbox', 'viridis', 'tigris')
# # install.packages('terra',repo='https://cran.r-project.org/')
# library(tigris)
# library(ggplot2)
# library(RStoolbox)
# install.packages('RStoolbox',repo='https://cran.r-project.org/')
lapply(p,require,character.only=TRUE)
# library(raster)
#Set the working directory
setwd('C:/Users/can02/mystuff/fireDieoff/pixel_sample')
#Set up a python environment
# ee_install(py_env = "rgee")
#Upgrade the python API version
# ee_install_upgrade(version = '0.1.312')
#Intialize RGEE
# ee_Initialize(user = 'cnorlen@uci.edu', drive = TRUE)
#Install a python package
# py_install("jsbeautifier")
#Import a python package
# regex <- import("regex")
# jsb <- import("jsbeautifier")
#Load a GEE package
# palettes <- module('users/gena/packages:palettes')
# js.batch <- 'https://github.com/fitoprincipe/geetools-code-editor/blob/master/batch'
# batch <- module(js.batch)
# batch
#Some how the LST module works, but other ones don't
# lsmod <- 'users/sofiaermida/landsat_smw_lst:modules/Landsat_LST.js'
# mod <- module(lsmod)
# mod
# geom <- ee$Geometry$Rectangle(-8.91, 40.0, -8.3, 40.4)
# LST <- mod$collection("L8", "2018-05-15", "2018-05-31", geom, TRUE)
# print(LST$first)
# LST$mean
# Map$addLayer(LST$first, {}, 'LST')
# frap.year <- ee$Image('users/cnorlen/Fire_Dieoff/frap_year_bin')
# yearViz <- list(
#   min = 1919,
#   max = 2020,
#   palette = c("yellow", "orange", "red")
# )
# Map$addLayer()
# Map$addLayer(frap.year, yearViz, 'FRAP Year Data')
#Setting variable for ESPG 5070, proj4 crs
c <- raster::crs("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs")
#Add California Boundary shape file
us_states_20m <- states(cb = TRUE, resolution = "20m", class = "sf")
us_states_20m <- st_transform(us_states_20m, c)
ca_20m <- us_states_20m[us_states_20m$NAME == "California", ]
ca_20m <- st_as_sf(ca_20m)
ca_20m <- st_transform(ca_20m, c)
#Select USFS EcoRegion for South Sierra Nevada
usfs_in <- "D:\\Large_Files\\USFS\\data\\subsections"
usfs.regions <- st_read(file.path(usfs_in, 'S_USA.EcomapSubsections.shp'))
usfs.sierra <- subset(usfs.regions, MAP_UNIT_S == 'M261Ep' | MAP_UNIT_S == 'M261Eq' | MAP_UNIT_S == 'M261Es' | MAP_UNIT_S == 'M261Eu' | MAP_UNIT_S == 'M261Er' | MAP_UNIT_S == 'M261Eo') # | MAP_UNIT_S == 'M261Ev') #MAP_UNIT_S == 'M261Et' |
#Merge Sierra Nevada polygons into one larger polygon
usfs.sierra.union <- usfs.sierra %>% st_union()
#Export the FRAP raster
# frap.raster <- ee_as_raster(image = frap.year, via = 'drive', container = 'Fire_Dieoff')
#Load in the exported data for my hard drive
data_in <- 'D://Fire_Dieoff'
files <- list.files(data_in)
files
frap.year.2010 <- raster::raster(file.path(data_in, 'FRAP_wildfire_2010_300m.tif'))
frap.year.2010.m <- frap.year.2010== 0
frap.year.2010.mask <-  raster::mask(frap.year.2010, mask = frap.year.2010.m, maskvalue = 1)
frap.buffer.year.2010 <- raster::raster(file.path(data_in, 'FRAP_wildfire_buffer_2010_300m.tif'))
frap.buffer.year.2010.m <- frap.buffer.year.2010== 0
frap.buffer.year.2010.mask <-  raster::mask(frap.buffer.year.2010, mask = frap.buffer.year.2010.m, maskvalue = 1)
#FRAP Rx Wildfire layer
rx.year.2010 <- raster::raster(file.path(data_in, 'FRAP_Rxfire_2010_300m.tif'))
rx.year.2010.m <- rx.year.2010== 0
rx.year.2010.mask <-  raster::mask(rx.year.2010, mask = rx.year.2010.m, maskvalue = 1)
rx.buffer.year.2010 <- raster::raster(file.path(data_in, 'FRAP_Rxfire_buffer_2010_300m.tif'))
rx.buffer.year.2010.m <- rx.buffer.year.2010== 0
rx.buffer.year.2010.mask <-  raster::mask(rx.year.buffer.2010, mask = rx.year.buffer.2010.m, maskvalue = 1)
#USFS Sev fire layer
sev.year.2010 <- raster::raster(file.path(data_in, 'USFS_fire_severity_2010_300m.tif'))
sev.year.2010.m <- sev.year.2010== 0
sev.year.2010.mask <-  raster::mask(sev.year.2010, mask = sev.year.2010.m, maskvalue = 1)
sev.buffer.year.2010 <- raster::raster(file.path(data_in, 'USFS_fire_severity_buffer_2010_300m.tif'))
sev.buffer.year.2010.m <- sev.buffer.year.2010== 0
sev.buffer.year.2010.mask <-  raster::mask(sev.year.buffer.2010, mask = sev.year.buffer.2010.m, maskvalue = 1)
sev.buffer.year.2010.m <- sev.buffer.year.2010 == 0
sev.buffer.year.2010.mask <-  raster::mask(sev.year.buffer.2010, mask = sev.year.buffer.2010.m, maskvalue = 1)
sev.buffer.year.2010.mask <-  raster::mask(sev.buffer.year.2010, mask = sev.buffer.year.2010.m, maskvalue = 1)
p1 <- ggplot() +
ggR(img = frap.year.2010.mask, layer = 1, maxpixels = 1e6, geom_raster = TRUE, ggLayer = TRUE) +
ggR(img = frap.buffer.year.2010.mask, layer = 1, maxpixels = 1e6, geom_raster = TRUE, ggLayer = TRUE, alpha = 0.4) +
geom_sf(data = ca_20m, color='black', size = 0.2, fill=NA) +
geom_sf(data = usfs.sierra.union, color='black', size = 0.4,  fill = NA) +
coord_sf() + xlab('longitude') + ylab('latitude') +
scale_fill_viridis(name = 'Fire Year', option = 'inferno', na.value = NA) + theme_bw() +
theme(
legend.justification = c(1, 0),
legend.position = c(0.89, 0.6),
legend.text = element_text(size = 6),
legend.title = element_text(size = 8),
legend.direction = "vertical")
p1
p1 <- ggplot() +
ggR(img = frap.buffer.year.2010.mask, layer = 1, maxpixels = 1e6, geom_raster = TRUE, ggLayer = TRUE, alpha = 0.4) +
ggR(img = frap.year.2010.mask, layer = 1, maxpixels = 1e6, geom_raster = TRUE, ggLayer = TRUE) +
geom_sf(data = ca_20m, color='black', size = 0.2, fill=NA) +
geom_sf(data = usfs.sierra.union, color='black', size = 0.4,  fill = NA) +
coord_sf() + xlab('longitude') + ylab('latitude') +
scale_fill_viridis(name = 'Fire Year', option = 'inferno', na.value = NA) + theme_bw() +
theme(
legend.justification = c(1, 0),
legend.position = c(0.89, 0.6),
legend.text = element_text(size = 6),
legend.title = element_text(size = 8),
legend.direction = "vertical")
p1
p1 <- ggplot() +
ggR(img = frap.buffer.year.2010.mask, layer = 1, maxpixels = 1e6, geom_raster = TRUE, ggLayer = TRUE, alpha = 0.2) +
ggR(img = frap.year.2010.mask, layer = 1, maxpixels = 1e6, geom_raster = TRUE, ggLayer = TRUE) +
geom_sf(data = ca_20m, color='black', size = 0.2, fill=NA) +
geom_sf(data = usfs.sierra.union, color='black', size = 0.4,  fill = NA) +
coord_sf() + xlab('longitude') + ylab('latitude') +
scale_fill_viridis(name = 'Fire Year', option = 'inferno', na.value = NA) + theme_bw() +
theme(
legend.justification = c(1, 0),
legend.position = c(0.89, 0.6),
legend.text = element_text(size = 6),
legend.title = element_text(size = 8),
legend.direction = "vertical")
p1
sierra.extent <- extent(bbox(usfs.sierra.union))
frap.year.2010.mask.crop <- st_crop(frap.year.mask.2010, sierra.extent)
frap.year.2010.mask
frap.year.2010.mask.crop <- st_crop(frap.year.2010.mask, sierra.extent)
frap.year.2010.mask.crop <- crop(frap.year.2010.mask, sierra.extent)
crs(sierra.extent) <- c
sierra.extent <- extent(bbox(usfs.sierra.union))
bbox(usfs.sierra.union)
usfs.sierra.union
bbox(usfs.sierra.union)
usfs.sierra.union$bbox
usfs.sierra.union$bbox
sierra.extent <- extent(usfs.sierra.union)
st_bbox(usfs.sierra.union)
sierra.extent <- extent(st_bbox(usfs.sierra.union))
sierra.extent <- st_as_sfc(st_bbox(usfs.sierra.union))
crs(sierra.extent) <- c
frap.year.2010.mask.crop <- crop(frap.year.2010.mask, sierra.extent)
sierra.extent <- extent(st_as_sfc(st_bbox(usfs.sierra.union)))
