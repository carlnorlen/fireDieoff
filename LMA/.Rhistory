q()
p <- c('ggpubr', 'viridis', 'tidyr', 'dplyr', 'ggplot2', 'stats', 'patchwork', 'data.table')
# install.packages(p,repo='https://cran.r-project.org/')
# install.packages(c('ggmap'),repo='https://cran.r-project.org/')
lapply(p,require,character.only=TRUE)
#Set the working directory
setwd('C:/Users/can02/mystuff/fireDieoff')
#Data directory
dir_in <- "D:\\Large_Files\\Fire_Dieoff"
#Add the data
data <- read.csv(file.path(dir_in, "Flux_tower_veg_indices_30m_11212021_v2.csv"), header = TRUE, na.strings = "NaN")
unique(data$Site)
#Rename the flux tower sites
data$site.name <- recode(.x=data$Site, 'US-SCg' ='Grassland US-SCg', 'US-SCf' = 'Oak Pine US-SCf', 'US-SCd' = 'Desert US-SCd', 'US-CZ3' = 'Mixed Conifer US-CZ3', 'US-SCw' = 'Pinyon US-SCw', 'US-CZ1' = 'Oak Pine US-CZ1', 'US-SCs' = 'Coastal Sage US-SCs',
'US-CZ4' = 'Subalpine US-CZ4', 'US-CZ2' = 'Ponderosa Pine US-CZ2', 'US-SCc' = 'Chaparral US-SCc')
#Format dates for the data
data$date <- as.Date(data$date)
data$year <- format(data$date, '%Y')
data$month <- format(data$date, '%m')
data$yday <- yday(data$date)
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean, color = year)) +
geom_point(size = 0.1) + facet_wrap(~ site.name) + ylab('LMA') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean, color = year)) +
geom_line(size = 0.1) + facet_wrap(~ site.name) + ylab('LMA') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_line(size = 0.1) + facet_wrap(~ site.name) + ylab('LMA') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_line(data = pixel.data %>%
group_by(yday, site.name) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_line(data = data %>%
group_by(yday, site.name) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_line(data = data %>%
group_by(yday, site.name) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(LMA_mean >= 0 & LMA_mean < 1 & !is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(10,1200), breaks = c(10,300,600,900), midpoint = 600, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
<- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,500), breaks = c(0,250), midpoint = 250, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,500), breaks = c(0,250), midpoint = 250, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,100), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
data <- data %>% mutate(decade.bin = case_when(
year >= 1984 & year <= 1990 ~ '1984-1990',
year >= 1991 & year <= 2000 ~ '1991-2000',
year >= 2001 & year <= 2010 ~ '2001-2010',
year >= 2011 & year <= 2020 ~ '2011-2019'))
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name, date.bin) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean, color = date.bin),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name, decade.bin) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean, color = decade.bin),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
summary(data)
summary(data %>% select(decade.bin) %>% unique())
data %>% select(decade.bin) %>% unique()
data
p1 <- ggplot(data = filter(data, LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x=yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
data %>%
group_by(yday, site.name, decade.bin) %>%
filter(!is.na(LMA_mean)) %>%
summarize(LMA.mean = mean(LMA_mean))
p1 <- ggplot(data = filter(data, !is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x = yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name, decade.bin) %>%
filter(!is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean, color = decade.bin),
color = 'black', size = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, !is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x = yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name, decade.bin) %>%
filter(!is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean, color = decade.bin),
ize = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
data <- data %>% mutate(decade.bin = case_when(
year >= 1984 & year <= 2000 ~ '1984-2000',
year >= 2001 & year <= 2020 ~ '2001-2019'))
p1 <- ggplot(data = filter(data, !is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x = yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name, decade.bin) %>%
filter(!is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean, color = decade.bin),
ize = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, !is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x = yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
ize = 1
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
p1 <- ggplot(data = filter(data, !is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1), mapping = aes(x = yday, y = LMA_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(LMA_mean) & LMA_mean >= 0 & LMA_mean < 1) %>%
summarize(LMA.mean = mean(LMA_mean)), mapping = aes(x = yday, y = LMA.mean),
size = 1, color = 'black'
) +
facet_wrap(~ site.name) + ylab(expression('LMA (g m'^-2*')')) +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p1
ggsave(filename = 'Fig1_Landsat_LMA_DOY.png', height=12, width=16, units = 'cm', dpi=900)
p2 <- ggplot(data = data, mapping = aes(x=yday, y = NDMI_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(NDMI_mean)) %>%
summarize(NDMI.mean = mean(NDMI_mean)), mapping = aes(x = yday, y = NDMI.mean),
size = 1, color = 'black'
) +
facet_wrap(~ site.name) + ylab('NDMI') +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p2
ggsave(filename = 'Fig2_Landsat_NDMI_DOY.png', height=12, width=16, units = 'cm', dpi=900)
p3 <- ggplot(data = data, mapping = aes(x=yday, y = NIRv_mean, color = year)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(NIRv_mean)) %>%
summarize(NIRv.mean = mean(NIRv_mean)), mapping = aes(x = yday, y = NIRv.mean),
size = 1, color = 'black'
) +
facet_wrap(~ site.name) + ylab('NIRv') +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p3
p3 <- ggplot(data = data, mapping = aes(x=yday, y = NIRv_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(NIRv_mean)) %>%
summarize(NIRv.mean = mean(NIRv_mean)), mapping = aes(x = yday, y = NIRv.mean),
size = 1, color = 'black'
) +
facet_wrap(~ site.name) + ylab('NIRv') +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p3
ggsave(filename = 'Fig3_Landsat_NIRv_DOY.png', height=12, width=16, units = 'cm', dpi=900)
p4 <- ggplot(data = data, mapping = aes(x=yday, y = NDVI_mean, color = year)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(NDVI_mean)) %>%
summarize(NDVI.mean = mean(NDVI_mean)), mapping = aes(x = yday, y = NDVI.mean),
size = 1, color = 'black'
) +
facet_wrap(~ site.name) + ylab('NDVI') +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p4
p4 <- ggplot(data = data, mapping = aes(x=yday, y = NDVI_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(NDVI_mean)) %>%
summarize(NDVI.mean = mean(NDVI_mean)), mapping = aes(x = yday, y = NDVI.mean),
size = 1, color = 'black'
) +
facet_wrap(~ site.name) + ylab('NDVI') +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p4
ggsave(filename = 'Fig4_Landsat_NDVI_DOY.png', height=12, width=16, units = 'cm', dpi=900)
p5 <- ggplot(data = data, mapping = aes(x=yday, y = brightness_mean)) +
geom_bin2d() +
geom_line(data = data %>%
group_by(yday, site.name) %>%
filter(!is.na(brightness_mean)) %>%
summarize(brightness.mean = mean(brightness_mean)), mapping = aes(x = yday, y = brightness.mean),
size = 1, color = 'black'
) +
facet_wrap(~ site.name) + ylab('Brightness') +
scale_fill_gradient2(limits = c(0,200), breaks = c(0,50,100,150), midpoint = 100, low = "cornflowerblue", mid = "yellow", high = "red", na.value = 'transparent') +
theme_bw()
p5
ggsave(filename = 'Fig5_Landsat_Brightness.png', height=12, width=16, units = 'cm', dpi=900)
data <- data %>% mutate(month.bin = case_when(
month == '02' | month == '03' | month == '04' ~ 'Feb-Apr',
month == '05' | month == '06' | month == '07' ~ 'May-Jul',
month == '10' | month == '09' | month == '10' ~ 'Aug-Oct'))
p6 <- ggplot() +
geom_line(data = data %>% filter((LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3") %>%
group_by(site.name, year, month.bin) %>%
mutate(LMA.mean = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mean, color = month.bin), size = 1) +
# geom_line(data = data %>% filter((month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == '04' | month == '05') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p6 <- ggplot() +
geom_line(data = data %>% filter((LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(LMA.mean = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mean, color = month.bin), size = 1) +
# geom_line(data = data %>% filter((month == '06' | month == '07') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3") %>%
#         group_by(site.name, year) %>% mutate(LMA.mid = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mid), color = 'blue', size = 1) +
# geom_line(data = data %>% filter((month == '04' | month == '05') & (LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3") %>%
#         group_by(site.name, year) %>% mutate(LMA.early = mean(LMA_mean)), mapping = aes(x = date, y = LMA.early), color = 'red', size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
p7 <- ggplot() +
geom_line(data = data %>% filter(!is.na(NDMI_mean) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(LMA.mean = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mean, color = month.bin), size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p6 <- ggplot() +
geom_line(data = data %>% filter((LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(LMA.mean = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mean, color = month.bin), size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
ggsave(filename = 'Fig6_Landsat_LMA_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p7 <- ggplot() +
geom_line(data = data %>% filter(!is.na(NDMI_mean) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(LMA.mean = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mean, color = month.bin), size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
p7 <- ggplot() +
geom_line(data = data %>% filter(!is.na(NDMI_mean) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(NDMI.mean = mean(NDMI_mean)), mapping = aes(x = date, y = NDMI.mean, color = month.bin), size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
ggsave(filename = 'Fig7_Landsat_NDMI_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p8 <- ggplot() +
geom_line(data = data %>% filter(!is.na(NIRv_mean) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(NIRv.mean = mean(NIRv_mean)), mapping = aes(x = date, y = NIRv.mean, color = month.bin), size = 1) +
xlab('Year') + ylab('NIRv') + facet_wrap(~ site.name) + theme_bw()
p8
p8 <- ggplot() +
geom_line(data = data %>% filter(!is.na(NIRv_mean) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & Site != "US-Scs" & Site != 'US-SCg' & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(NIRv.mean = mean(NIRv_mean)), mapping = aes(x = date, y = NIRv.mean, color = month.bin), size = 1) +
xlab('Year') + ylab('NIRv') + facet_wrap(~ site.name) + theme_bw()
p8
p8 <- ggplot() +
geom_line(data = data %>% filter(!is.na(NIRv_mean) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & Site != "US-SCs" & Site != 'US-SCg' & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(NIRv.mean = mean(NIRv_mean)), mapping = aes(x = date, y = NIRv.mean, color = month.bin), size = 1) +
xlab('Year') + ylab('NIRv') + facet_wrap(~ site.name) + theme_bw()
p8
ggsave(filename = 'Fig8_Landsat_NIRv_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p7 <- ggplot() +
geom_line(data = data %>% filter(!is.na(NDMI_mean) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3"& Site != "US-SCs" & Site != 'US-SCg'  & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(NDMI.mean = mean(NDMI_mean)), mapping = aes(x = date, y = NDMI.mean, color = month.bin), size = 1) +
xlab('Year') + ylab('NDMI') + facet_wrap(~ site.name) + theme_bw()
p7
ggsave(filename = 'Fig7_Landsat_NDMI_time_series.png', height=12, width=16, units = 'cm', dpi=900)
p6 <- ggplot() +
geom_line(data = data %>% filter((LMA_mean < 1 & LMA_mean > -1) & Site != "US-SCd" & Site != "US-CZ4" & Site != "US-CZ3" & Site != "US-SCs" & Site != 'US-SCg' & !is.na(month.bin)) %>%
group_by(site.name, year, month.bin) %>%
mutate(LMA.mean = mean(LMA_mean)), mapping = aes(x = date, y = LMA.mean, color = month.bin), size = 1) +
xlab('Year') + ylab(expression('LMA (g m'^-2*')')) + facet_wrap(~ site.name) + theme_bw()
p6
ggsave(filename = 'Fig6_Landsat_LMA_time_series.png', height=12, width=16, units = 'cm', dpi=900)
