filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)), mapping = aes(x = disturb.bin, y = BA.all, color = disturb.bin), size = 1) +
#95% CI Die-of
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p1
p2<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), count = n()),
mapping = aes(x = disturb.bin, y = count, color = 'disturb.bin'), size = 1) +
#95% CI Die-off
# geom_ribbon(data = join %>% filter(!is.na(stdage.bin)) %>%
#               group_by(INVYR) %>%
#               summarize(BA.dead = mean(basal_area.dead),
#                         BA.dead.sd = sd(basal_area.dead), BA.n = n()),
#             mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           x = INVYR), alpha = 0.3) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab('# Plots')
p2
p3<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = disturb.bin),  size = 1) +
#95% CI Die-off
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p3
dead <- all %>% filter(STATUSCD == 2 & AGENTCD %in% cd(30, 31, 32)) %>% group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
# dead <- dead %>% mutate(INVYR = MORTYR) & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019")
# dead
join <- left_join(live, dead, by = c('PLOT', 'INVYR'))
#Replace the NAs with 0s
join <- join %>% dplyr::mutate(basal_area.dead = replace(basal_area.dead, is.na(basal_area.dead), 0),
count.dead = replace(count.dead, is.na(count.dead), 0),
tpa.dead = replace(tpa.dead, is.na(tpa.dead), 0))
summary(join)
#Add the total basal area calculations
join$count.all <- join$count.live + join$count.dead
join$tpa.all <- join$tpa.live + join$tpa.dead
join$basal_area.all <- join$basal_area.live + join$basal_area.dead
join$basal_area.dead.pct <- join$basal_area.dead / join$basal_area.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join <- join %>% dplyr::mutate(basal_area.dead.pct = replace(basal_area.dead.pct, is.na(basal_area.dead.pct), 0))
join$tpa.dead.pct <- join$tpa.dead / join$tpa.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join <- join %>% dplyr::mutate(tpa.dead.pct = replace(tpa.dead.pct, is.na(tpa.dead.pct), 0))
#Test out the basal area
p1 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join  %>% # filter(DSTRBYR1 >= 2012 | is.na(DSTRBYR1)) %>%
group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all), BA.n = n()), mapping = aes(x = INVYR, y = BA.all), color = 'black', size = 1) +
#The error bars
geom_ribbon(data = join %>%
group_by(INVYR) %>%
summarize(BA.mean = mean(basal_area.all),
BA.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(ymin=BA.mean - 1.96*(BA.sd / sqrt(BA.n)),
ymax=BA.mean + 1.96*(BA.sd / sqrt(BA.n)),
x = INVYR), alpha = 0.3) + #ylim(0, 45) +
xlab('Year') + ylab(expression('Basal Area (m'^2*' ha'^-1*')')) + theme_bw()
p1
dead <- all %>% filter(STATUSCD == 2 & AGENTCD %in% c(30, 31, 32)) %>% group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
# dead <- dead %>% mutate(INVYR = MORTYR) & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019")
# dead
join <- left_join(live, dead, by = c('PLOT', 'INVYR'))
#Replace the NAs with 0s
join <- join %>% dplyr::mutate(basal_area.dead = replace(basal_area.dead, is.na(basal_area.dead), 0),
count.dead = replace(count.dead, is.na(count.dead), 0),
tpa.dead = replace(tpa.dead, is.na(tpa.dead), 0))
summary(join)
#Add the total basal area calculations
join$count.all <- join$count.live + join$count.dead
join$tpa.all <- join$tpa.live + join$tpa.dead
join$basal_area.all <- join$basal_area.live + join$basal_area.dead
join$basal_area.dead.pct <- join$basal_area.dead / join$basal_area.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join <- join %>% dplyr::mutate(basal_area.dead.pct = replace(basal_area.dead.pct, is.na(basal_area.dead.pct), 0))
join$tpa.dead.pct <- join$tpa.dead / join$tpa.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join <- join %>% dplyr::mutate(tpa.dead.pct = replace(tpa.dead.pct, is.na(tpa.dead.pct), 0))
p1 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join  %>% # filter(DSTRBYR1 >= 2012 | is.na(DSTRBYR1)) %>%
group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all), BA.n = n()), mapping = aes(x = INVYR, y = BA.all), color = 'black', size = 1) +
#The error bars
geom_ribbon(data = join %>%
group_by(INVYR) %>%
summarize(BA.mean = mean(basal_area.all),
BA.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(ymin=BA.mean - 1.96*(BA.sd / sqrt(BA.n)),
ymax=BA.mean + 1.96*(BA.sd / sqrt(BA.n)),
x = INVYR), alpha = 0.3) + #ylim(0, 45) +
xlab('Year') + ylab(expression('Basal Area (m'^2*' ha'^-1*')')) + theme_bw()
p1
# join %>% summary()
join$years.disturb <- join$INVYR - join$DSTRBYR1
join %>% filter(DSTRBCD1 %in% c('31', '32') & INVYR %in% c('2001', '2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013')) %>% group_by(DSTRBCD1) %>% count()
join <- join %>% mutate(disturb.bin = case_when(
# DSTRBCD1 %in% c(10, 11, 12, 54, 70) ~ 'Die-off',
DSTRBCD1 %in% c(31) ~ 'Ground Fire',
DSTRBCD1 %in% c(32) ~ 'Crown Fire',
DSTRBCD1 == 0 ~'No Disturbance'))
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)), mapping = aes(x = disturb.bin, y = BA.all, color = disturb.bin), size = 1) +
#95% CI Die-of
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p1
p2<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), count = n()),
mapping = aes(x = disturb.bin, y = count, color = 'disturb.bin'), size = 1) +
#95% CI Die-off
# geom_ribbon(data = join %>% filter(!is.na(stdage.bin)) %>%
#               group_by(INVYR) %>%
#               summarize(BA.dead = mean(basal_area.dead),
#                         BA.dead.sd = sd(basal_area.dead), BA.n = n()),
#             mapping = aes(ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
#                           x = INVYR), alpha = 0.3) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab('# Plots')
p2
p3<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = disturb.bin),  size = 1) +
#95% CI Die-off
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Mortality (m'^2*' ha'^-1*')'))
p3
p4<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)) %>% # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), STDAGE.mean = mean(STDAGE)),
mapping = aes(x = disturb.bin, y = STDAGE.mean, color = disturb.bin), size = 1) +
#95% CI Error bar
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)) %>%
group_by(disturb.bin) %>%
summarize(STDAGE.mean = mean(STDAGE),
STDAGE.mean.sd = sd(STDAGE), BA.n = n()),
mapping = aes(y = STDAGE.mean, ymin=STDAGE.mean - 1.96*(STDAGE.mean.sd / sqrt(BA.n)),
ymax=STDAGE.mean + 1.96*(STDAGE.mean.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Past Disturbance Type') + ylab('Average Tree Age')
p4
f1 <- ggarrange(p1, p3, p4, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'c)', 'd)'))
f1
p3<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = disturb.bin),  size = 1) +
#95% CI Die-off
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Fire Mortality (m'^2*' ha'^-1*')'))
p3
f1 <- ggarrange(p1, p3, p4, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'c)', 'd)'))
f1
ggsave(filename = 'Fig16_FIA_fire_recovery_exploration.png', height=15, width= 10, units = 'cm', dpi=900)
p2<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), BA.live = mean(basal_area.live)),
mapping = aes(x = disturb.bin, y = BA.all, color = disturb.bin), size = 1) +
#95% CI Die-of
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.live = mean(basal_area.live),
BA.live.sd = sd(basal_area.live), BA.n = n()),
mapping = aes(y = BA.live, ymin=BA.live - 1.96*(BA.live.sd / sqrt(BA.n)),
ymax=BA.live + 1.96*(BA.live.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Live Basal Area (m'^2*' ha'^-1*')'))
p2
p2<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), BA.live = mean(basal_area.live)),
mapping = aes(x = disturb.bin, y = BA.live, color = disturb.bin), size = 1) +
#95% CI Die-of
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.live = mean(basal_area.live),
BA.live.sd = sd(basal_area.live), BA.n = n()),
mapping = aes(y = BA.live, ymin=BA.live - 1.96*(BA.live.sd / sqrt(BA.n)),
ymax=BA.live + 1.96*(BA.live.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Live Basal Area (m'^2*' ha'^-1*')'))
p2
p1
live <- all %>% filter(STATUSCD == 1) %>% group_by(INVYR, PLOT) %>% summarize(count.live = n(), tpa.live = sum(count), basal_area.live = sum(basal_area), STDAGE = first(STDAGE),
FORTYPCD = first(FORTYPCD), MEANING = first(MEANING), DSTRBCD1 = first(DSTRBCD1),
DSTRBYR1 = first(DSTRBYR1), OWNGRPCD = first(OWNGRPCD))
# live
#There is a slightly different result when using INVYR instead of MORTYR to calculate annual mortality
dead <- all %>% filter(STATUSCD == 2 & AGENTCD %in% c(70, 30, 31, 32)) %>% group_by(PLOT, INVYR) %>% summarize(count.dead = n(), tpa.dead = sum(count), basal_area.dead = sum(basal_area))
# dead <- dead %>% mutate(INVYR = MORTYR) & MORTYR %in% c("2013", "2014", "2015", "2016", "2017", "2018", "2019")
# dead
join <- left_join(live, dead, by = c('PLOT', 'INVYR'))
#Replace the NAs with 0s
join <- join %>% dplyr::mutate(basal_area.dead = replace(basal_area.dead, is.na(basal_area.dead), 0),
count.dead = replace(count.dead, is.na(count.dead), 0),
tpa.dead = replace(tpa.dead, is.na(tpa.dead), 0))
summary(join)
#Add the total basal area calculations
join$count.all <- join$count.live + join$count.dead
join$tpa.all <- join$tpa.live + join$tpa.dead
join$basal_area.all <- join$basal_area.live + join$basal_area.dead
join$basal_area.dead.pct <- join$basal_area.dead / join$basal_area.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join <- join %>% dplyr::mutate(basal_area.dead.pct = replace(basal_area.dead.pct, is.na(basal_area.dead.pct), 0))
join$tpa.dead.pct <- join$tpa.dead / join$tpa.all
#fill the NAs for basal_area.dead.pct, this could go earlier
join <- join %>% dplyr::mutate(tpa.dead.pct = replace(tpa.dead.pct, is.na(tpa.dead.pct), 0))
#Test out the basal area
p1 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#The data mean
geom_line(data = join  %>% # filter(DSTRBYR1 >= 2012 | is.na(DSTRBYR1)) %>%
group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all), BA.n = n()), mapping = aes(x = INVYR, y = BA.all), color = 'black', size = 1) +
#The error bars
geom_ribbon(data = join %>%
group_by(INVYR) %>%
summarize(BA.mean = mean(basal_area.all),
BA.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(ymin=BA.mean - 1.96*(BA.sd / sqrt(BA.n)),
ymax=BA.mean + 1.96*(BA.sd / sqrt(BA.n)),
x = INVYR), alpha = 0.3) + #ylim(0, 45) +
xlab('Year') + ylab(expression('Basal Area (m'^2*' ha'^-1*')')) + theme_bw()
p1
# join %>% summary()
join$years.disturb <- join$INVYR - join$DSTRBYR1
join %>% filter(DSTRBCD1 %in% c('31', '32') & INVYR %in% c('2001', '2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013')) %>% group_by(DSTRBCD1) %>% count()
join <- join %>% mutate(disturb.bin = case_when(
# DSTRBCD1 %in% c(10, 11, 12, 54, 70) ~ 'Die-off',
DSTRBCD1 %in% c(31) ~ 'Ground Fire',
DSTRBCD1 %in% c(32) ~ 'Crown Fire',
DSTRBCD1 == 0 ~'No Disturbance'))
#Region white counts of dead and live trees
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)), mapping = aes(x = disturb.bin, y = BA.all, color = disturb.bin), size = 1) +
#95% CI Die-of
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p1
p2<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), BA.live = mean(basal_area.live)),
mapping = aes(x = disturb.bin, y = BA.live, color = disturb.bin), size = 1) +
#95% CI Die-of
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.live = mean(basal_area.live),
BA.live.sd = sd(basal_area.live), BA.n = n()),
mapping = aes(y = BA.live, ymin=BA.live - 1.96*(BA.live.sd / sqrt(BA.n)),
ymax=BA.live + 1.96*(BA.live.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Live Basal Area (m'^2*' ha'^-1*')'))
p2
p3<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)),
mapping = aes(x = disturb.bin, y = BA.dead, color = disturb.bin),  size = 1) +
#95% CI Die-off
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.dead = mean(basal_area.dead),
BA.dead.sd = sd(basal_area.dead), BA.n = n()),
mapping = aes(y = BA.dead, ymin=BA.dead - 1.96*(BA.dead.sd / sqrt(BA.n)),
ymax=BA.dead + 1.96*(BA.dead.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Fire Mortality (m'^2*' ha'^-1*')'))
p3
p4<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)) %>% # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), STDAGE.mean = mean(STDAGE)),
mapping = aes(x = disturb.bin, y = STDAGE.mean, color = disturb.bin), size = 1) +
#95% CI Error bar
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)) %>%
group_by(disturb.bin) %>%
summarize(STDAGE.mean = mean(STDAGE),
STDAGE.mean.sd = sd(STDAGE), BA.n = n()),
mapping = aes(y = STDAGE.mean, ymin=STDAGE.mean - 1.96*(STDAGE.mean.sd / sqrt(BA.n)),
ymax=STDAGE.mean + 1.96*(STDAGE.mean.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
# theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Past Disturbance Type') + ylab('Average Tree Age')
p4
f1 <- ggarrange(p1, p3, p4, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'c)', 'd)'))
f1
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)), mapping = aes(x = disturb.bin, y = BA.all, color = disturb.bin), size = 1) +
#95% CI Die-of
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p1
f1 <- ggarrange(p1, p3, p4, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'c)', 'd)'))
f1
ggsave(filename = 'Fig16_FIA_fire_recovery_exploration.png', height=15, width= 10, units = 'cm', dpi=900)
p1<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_point(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>% summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead)), mapping = aes(x = disturb.bin, y = BA.all, color = disturb.bin), size = 1) +
#95% CI Die-of
geom_errorbar(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire')) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all),
BA.all.sd = sd(basal_area.all), BA.n = n()),
mapping = aes(y = BA.all, ymin=BA.all - 1.96*(BA.all.sd / sqrt(BA.n)),
ymax=BA.all + 1.96*(BA.all.sd / sqrt(BA.n)),
x = disturb.bin, color = disturb.bin)) +
theme_bw() +
# ylim(0, 40) +
theme(axis.title.x = element_blank(), axis.text.x = element_blank()) +
xlab('Disturbance Type') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p1
f1 <- ggarrange(p1, p3, p4, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'c)', 'd)'))
f1
ggsave(filename = 'Fig16_FIA_fire_recovery_exploration.png', height=15, width= 10, units = 'cm', dpi=900)
p4<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)) %>% # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), STDAGE.mean = mean(STDAGE)),
mapping = aes(color = disturb.bin, x = BA.all, color = disturb.bin), size = 1)
p4
p4<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)) %>% # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
group_by(disturb.bin) %>%
summarize(BA.all = mean(basal_area.all), BA.dead = mean(basal_area.dead), STDAGE.mean = mean(STDAGE)),
mapping = aes(fill = disturb.bin, x = BA.all), size = 1)
p4
p4<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)), # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
mapping = aes(fill = disturb.bin, x = BA.all), size = 1)
p4
p4<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)), # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
mapping = aes(fill = disturb.bin, x = basal_area.all), size = 1)
p4
p4<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)), # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
mapping = aes(fill = disturb.bin, x = basal_area.all), size = 1, alpha =0.5)
p4
all %>% filter(STATUSCD == 2)
all %>% filter(STATUSCD == 1)
p4<- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)), # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
mapping = aes(fill = disturb.bin, x = basal_area.all), size = 1, alpha =0.5) + theme_bw() +
xlab('Density') + ylab(expression('Basal Area (m'^2*' ha'^-1*')'))
p4
p5 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)), # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
mapping = aes(fill = disturb.bin, x = basal_area.dead), size = 1, alpha =0.5) + theme_bw() +
ylab('Density') + xlab(expression('Mortality (m'^2*' ha'^-1*')'))
p5
p6 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('No Disturbance', 'Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)), # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
mapping = aes(fill = disturb.bin, x = STDAGE), size = 1, alpha =0.5) + theme_bw() +
ylab('Density') + xlab('Average Tree Age')
p6
f2 <- ggarrange(p5, p6, p7, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'c)', 'd)'))
f2
ggsave(filename = 'Fig17_FIA_fire_recovery_desnity_plots_exploration.png', height=15, width= 10, units = 'cm', dpi=900)
f2 <- ggarrange(p4, p5, p6, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'c)', 'd)'))
f2
ggsave(filename = 'Fig17_FIA_fire_recovery_desnity_plots_exploration.png', height=15, width= 10, units = 'cm', dpi=900)
p5 <- ggplot() + #geom_line(data = join %>% group_by(INVYR) %>% summarize(BA.all = mean(basal_area.all)), mapping = aes(x = INVYR, y = BA.all), color = 'green') +
#Mean Die-off
geom_density(data = join %>%
filter(!is.na(disturb.bin) & disturb.bin %in% c('Crown Fire', 'Ground Fire') & (!is.na(STDAGE) & STDAGE != 9999)), # & INVYR %in% c("2015", "2016", "2017", "2018", "2019") ) %>%
mapping = aes(fill = disturb.bin, x = basal_area.dead), size = 1, alpha =0.5) + theme_bw() +
ylab('Density') + xlab(expression('Mortality (m'^2*' ha'^-1*')'))
p5
f2 <- ggarrange(p4, p5, p6, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9, 1), align = "v", labels = c('a)', 'c)', 'd)'))
f2
ggsave(filename = 'Fig17_FIA_fire_recovery_desnity_plots_exploration.png', height=15, width= 10, units = 'cm', dpi=900)
