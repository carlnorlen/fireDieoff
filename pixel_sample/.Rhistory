geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
dplyr::select(fire.year) %>%
unique() %>%
summarize(fire.year.count = n()), mapping = aes(x = stand.age, y = fire.year.count), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression('# Fire Years')) + xlab('Years Since Fire') #+ facet_wrap(. ~ fire_type_last, labeller = as_labeller(c('1' = 'Wild', '2' = 'Prescribed')))
p1c
find_mode <- function(x) {
u <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
p1d <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(fire_year.mode = find_mode(fire_year_2010)), mapping = aes(x = stand.age, y = fire_year.mode), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) + ylim(1910, 2010) +
ylab(expression('Modal Fire Year')) + xlab('Years Since Fire')
p1d
f1a <- ggarrange(p1a, p1b, p1c, p1d, ncol = 1, nrow = 4, common.legend = FALSE, heights = c(0.9, 0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)', 'd)'))
f1a
#Save the data
ggsave(filename = 'Fig1_data_check_50pt_frap_perimeter_chronosequence.png', height=22, width= 16, units = 'cm', dpi=900)
p14 <- ggplot() +
#The full data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]) / Tree_Cover[vi.year == 2012], stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]) / Tree_Cover[vi.year == 2012], stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age, y = dTree), size = 2) +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
ggsave(filename = 'Fig9_dTree_stand_age_wildfire_frap_50pt_sample.png', height=16, width= 18, units = 'cm', dpi=900)
p14 <- ggplot() +
#The full data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age, y = dTree), size = 2) +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
ggsave(filename = 'Fig9_dTree_stand_age_wildfire_frap_50pt_sample.png', height=16, width= 18, units = 'cm', dpi=900)
p16 <- ggplot() +
#The full data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], Tree = Tree[vi.year == 2012]),
mapping = aes(x = Tree, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
#              group_by(stand.age) %>%
#              summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
#            mapping = aes(x = stand.age, y = dTree), size = 2) +
# # geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p16
p16 <- ggplot() +
#The full data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2012]),
mapping = aes(x = Tree, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
#              group_by(stand.age) %>%
#              summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
#            mapping = aes(x = stand.age, y = dTree), size = 2) +
# # geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p16
ggsave(filename = 'Fig11_dTree_frap_50pts.png', height=16, width= 18, units = 'cm', dpi=900)
pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]) / Tree_Cover[vi.year == 2012])
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(RdTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]) / Tree_Cover[vi.year == 2012]),
mapping = aes(x = stand.age, y = RdTree))
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(RdTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]) / Tree_Cover[vi.year == 2012], stand.age = stand.age[vi.year == 2010]),
mapping = aes(x = stand.age, y = RdTree))
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910 & Tree_Cover >= 25) %>%
dplyr::group_by(system.index) %>%
summarize(RdTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010]),
mapping = aes(x = stand.age, y = RdTree))
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910 & Tree_Cover >= 30) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010]),
mapping = aes(x = stand.age, y = dTree))
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910 & Tree_Cover >= 50) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010]),
mapping = aes(x = stand.age, y = dTree))
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910 & Tree_Cover >= 80) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010]),
mapping = aes(x = stand.age, y = dTree))
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910 & Tree_Cover >= 70) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010]),
mapping = aes(x = stand.age, y = dTree))
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910 & Tree_Cover >= 60) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010]),
mapping = aes(x = stand.age, y = dTree))
ggplot() + geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910 & Tree_Cover >= 20) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010]),
mapping = aes(x = stand.age, y = dTree))
p16 <- ggplot(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910 & Tree_Cover >= 25) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2012])) +
geom_point(mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
#              group_by(stand.age) %>%
#              summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
#            mapping = aes(x = stand.age, y = dTree), size = 2) +
geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p16
p16 <- ggplot(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2012])) +
geom_point(mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
#              group_by(stand.age) %>%
#              summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
#            mapping = aes(x = stand.age, y = dTree), size = 2) +
geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p16
p16 <- ggplot(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2012])) +
geom_point(mapping = aes(x = Tree, y = dTree), size = 0.5, alpha = 0.3, color = 'black') +
#The summarized data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
#              group_by(stand.age) %>%
#              summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
#            mapping = aes(x = stand.age, y = dTree), size = 2) +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
xlab('Tree Cover (%)') + ylab('dTree Cover (%)')
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p16
ggsave(filename = 'Fig11_dTree_Tree_frap_50pts.png', height=16, width= 18, units = 'cm', dpi=900)
p16 <- ggplot(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2012])) +
geom_point(mapping = aes(x = Tree, y = dTree), size = 0.5, alpha = 0.3, color = 'black') +
#The summarized data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
#              group_by(stand.age) %>%
#              summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
#            mapping = aes(x = stand.age, y = dTree), size = 2) +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
xlab('Tree Cover (%)') + ylab('dTree Cover (%)') +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p16
ggsave(filename = 'Fig11_dTree_Tree_frap_50pts.png', height=16, width= 18, units = 'cm', dpi=900)
pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2012]) %>%
group_by(stand.age) %>%
filter(dTree == 0) %>% count()
test <- pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2012]) %>%
group_by(stand.age) %>%
filter(dTree == 0) %>% count()
View(test)
p16 <- ggplot(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2017] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], Tree = Tree_Cover[vi.year == 2015])) +
geom_point(mapping = aes(x = Tree, y = dTree), size = 0.5, alpha = 0.3, color = 'black') +
#The summarized data
# geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
#              dplyr::group_by(system.index) %>%
#              summarize(dTree = (Tree_Cover[vi.year == 2016] - Tree_Cover[vi.year == 2012]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
#              group_by(stand.age) %>%
#              summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
#            mapping = aes(x = stand.age, y = dTree), size = 2) +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
xlab('Tree Cover (%)') + ylab('dTree Cover (%)') +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p16
ggsave(filename = 'Fig11_dTree_Tree_frap_50pts.png', height=16, width= 18, units = 'cm', dpi=900)
p14 <- ggplot() +
#The full data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2017] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2015] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age, y = dTree), size = 2) +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
ggsave(filename = 'Fig9_dTree_stand_age_wildfire_frap_50pt_sample.png', height=16, width= 18, units = 'cm', dpi=900)
p14 <- ggplot() +
#The full data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2017] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2017] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age, y = dTree), size = 2) +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
ggsave(filename = 'Fig9_dTree_stand_age_wildfire_frap_50pt_sample.png', height=16, width= 18, units = 'cm', dpi=900)
p14 <- ggplot() +
#The full data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2017] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]),
mapping = aes(x = stand.age, y = dTree), size = 0.5, alpha = 0.3, color = 'gray') +
#The summarized data
geom_point(data = pixel.data %>% dplyr::filter(!is.na(stand.age) & stand.age >= 0 & fire.year <= 2010 & fire.year >= 1910) %>%
dplyr::group_by(system.index) %>%
summarize(dTree = (Tree_Cover[vi.year == 2017] - Tree_Cover[vi.year == 2015]), stand.age = stand.age[vi.year == 2010], SPI48 = SPI48[vi.year == 2015]) %>%
group_by(stand.age) %>%
summarize(dTree = mean(dTree), dTree.n = n(), dTree.sd = sd(dTree)),
mapping = aes(x = stand.age, y = dTree), size = 2) + ylim(-25, 25) +
# geom_smooth(method = 'lm', mapping = aes(x = stand.age, y = dTree), linetype = 'dotdash', size = 2) +
# stat_cor(mapping = aes(x = stand.age, y = dTree)) +
theme_bw() #+ facet_grid(. ~ lf_evt_2001)
p14
ggsave(filename = 'Fig9_dTree_stand_age_wildfire_frap_50pt_sample.png', height=16, width= 18, units = 'cm', dpi=900)
p1c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
dplyr::select(FIRE_NAME) %>%
unique() %>%
summarize(fire.year.count = n()), mapping = aes(x = stand.age, y = fire.year.count), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression('# Fire Perimeters')) + xlab('Years Since Fire') #+ facet_wrap(. ~ fire_type_last, labeller = as_labeller(c('1' = 'Wild', '2' = 'Prescribed')))
p1c
p1a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(Tree_Cover.mean = mean(Tree_Cover), Tree_Cover.n = n()), mapping = aes(x = stand.age, y = Tree_Cover.n), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression('Pixel #')) #+ xlab('Years Since Fire') #+ facet_wrap(. ~ fire_type_last, labeller = as_labeller(c('1' = 'Wild', '2' = 'Prescribed')))
p1a
p1b <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(elevation.mean = mean(elevation), elevation.sd = sd(elevation), elevation.n = n()), mapping = aes(x = stand.age, y = elevation.mean), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression('Elevation (m)')) #+ xlab('Years Since Fire') #+ facet_wrap(. ~ fire_type_last, labeller = as_labeller(c('1' = 'Wild', '2' = 'Prescribed')))
p1b
summary(pixel.data)
pixel.data %>% filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>% dplyr::select(fire.year) %>% unique() %>% summarize(count = n())
p1c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
dplyr::select(FIRE_NAME) %>%
unique() %>%
summarize(fire.year.count = n()), mapping = aes(x = stand.age, y = fire.year.count), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression('# Fire Perimeters')) #+ xlab('Years Since Fire') #+ facet_wrap(. ~ fire_type_last, labeller = as_labeller(c('1' = 'Wild', '2' = 'Prescribed')))
p1c
find_mode <- function(x) {
u <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
p1d <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(fire_year.mode = find_mode(fire_year_2010)), mapping = aes(x = stand.age, y = fire_year.mode), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) + ylim(1900, 2010) +
ylab(expression('Modal Fire Year')) #+ xlab('Years Since Fire')
p1d
p1e <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(vi.year.mode = find_mode(vi.year)), mapping = aes(x = stand.age, y = vi.year.mode), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) + ylim(1900, 2010) +
ylab(expression('Modal VI Year')) + xlab('Years Since Fire')
p1e
f1a <- ggarrange(p1a, p1b, p1c, p1d, p1e, ncol = 1, nrow = 5, common.legend = FALSE, heights = c(0.9, 0.9, 0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)', 'd)', 'e)'))
f1a
p1a <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(Tree_Cover.mean = mean(Tree_Cover), Tree_Cover.n = n()), mapping = aes(x = stand.age, y = Tree_Cover.n), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression('# Pixels')) #+ xlab('Years Since Fire') #+ facet_wrap(. ~ fire_type_last, labeller = as_labeller(c('1' = 'Wild', '2' = 'Prescribed')))
p1a
p1b <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(elevation.mean = mean(elevation), elevation.sd = sd(elevation), elevation.n = n()), mapping = aes(x = stand.age, y = elevation.mean), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression('Elevation (m)')) #+ xlab('Years Since Fire') #+ facet_wrap(. ~ fire_type_last, labeller = as_labeller(c('1' = 'Wild', '2' = 'Prescribed')))
p1b
summary(pixel.data)
pixel.data %>% filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>% dplyr::select(fire.year) %>% unique() %>% summarize(count = n())
p1c <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
dplyr::select(FIRE_NAME) %>%
unique() %>%
summarize(fire.year.count = n()), mapping = aes(x = stand.age, y = fire.year.count), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression('# Fire Perimeters')) #+ xlab('Years Since Fire') #+ facet_wrap(. ~ fire_type_last, labeller = as_labeller(c('1' = 'Wild', '2' = 'Prescribed')))
p1c
find_mode <- function(x) {
u <- unique(x)
tab <- tabulate(match(x, u))
u[tab == max(tab)]
}
p1d <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(fire_year.mode = find_mode(fire_year_2010)), mapping = aes(x = stand.age, y = fire_year.mode), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_blank(), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) + ylim(1900, 2010) +
ylab(expression('Modal Fire Year')) #+ xlab('Years Since Fire')
p1d
p1e <- ggplot() +
# geom_line(mapping = aes(group = .geo), color = 'dark gray', size = 0.2, alpha = 0.2) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0, linetype = 'dashed') +
geom_vline(xintercept = -10, color = 'red') +
geom_vline(xintercept = 70, color = 'red') +
#Create a shrub cover line
geom_line(data = pixel.data %>%
filter(!is.na(Shrub_Cover) & vi.year <= 2010 & fire.year <= 2010 & !is.na(fire.year)) %>%
group_by(stand.age) %>%
summarize(vi.year.mode = find_mode(vi.year)), mapping = aes(x = stand.age, y = vi.year.mode), size = 1) +
theme_bw() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10), legend.position = c(0.35, 0.8), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_text(size = 8),
legend.title = element_text(size = 8), legend.text = element_text(size = 6)) + ylim(1985, 2010) +
ylab(expression('Modal VI Year')) + xlab('Years Since Fire')
p1e
f1a <- ggarrange(p1a, p1b, p1c, p1d, p1e, ncol = 1, nrow = 5, common.legend = FALSE, heights = c(0.9, 0.9, 0.9, 0.9, 1), align = "v", labels = c('a)', 'b)', 'c)', 'd)', 'e)'))
f1a
#Save the data
ggsave(filename = 'Fig1_data_check_50pt_frap_perimeter_chronosequence.png', height=22, width= 16, units = 'cm', dpi=900)
